function CloudspongeCore(e){if(this.inlineOauth=e.inlineOauth,this.oauthWindowName=e.oauthWindowName,this.onProgress=e.onProgress,this.onCSVStart=e.onCSVStart,this.onCredentialStart=e.onCredentialStart,this.onEvents=e.onEvents,this.onInitializingStart=e.onInitializingStart,this.onGatheringStarted=e.onGatheringStarted,this.onContacts=e.onContacts,this.onError=e.onError,this.onAbandon=e.onAbandon,this.logger=e.logger,this.extraOptions=e.extraOptions,e.jwt&&!e.importId)try{e.importId=JSON.parse(atob(e.jwt.split(".")[1])).jti}catch(o){}this.jwt=e.jwt,this.source=e.source&&e.source.toLowerCase(),this.importId=e.importId,this.canceling=!1,this.pollTimeout=null;var t=this._parseURLParams();t.import_id&&(this.importId=t.import_id),this.source&&this.importId&&this._pollEvents(this.source,this.importId),this._oauthWin=null}window.cloudsponge=window.cloudsponge||{},function(){if(!cloudsponge.require){var l={},i={},a=function(e,t){var o,s,n=r(t,e),c=r(n,"./index");if(o=i[n]||i[c])return o;if(s=l[n]||l[n=c])return o={id:n,exports:{}},i[n]=o.exports,s(o.exports,function(e){return a(e,d(n))},o),i[n]=o.exports;throw"module "+e+" not found"},r=function(e,t){for(var o,s,n=[],c=0,l=(o=/^\.\.?(\/|$)/.test(t)?[e,t].join("/").split("/"):t.split("/")).length;c<l;c++)".."==(s=o[c])?n.pop():"."!=s&&""!=s&&n.push(s);return n.join("/")},d=function(e){return e.split("/").slice(0,-1).join("/")};cloudsponge.require=function(e){return a(e,"")},cloudsponge.require.define=function(e){for(var t in e)l[t]=e[t]},cloudsponge.require.modules=l,cloudsponge.require.cache=i}return cloudsponge.require}.call(this),cloudsponge.require.define({"lib/cors":function(e,t,o){var s=function(e){try{return JSON.parse(e)}catch(t){return e}},n=function(){var e=new XMLHttpRequest;return"withCredentials"in e?e:"undefined"!=typeof XDomainRequest?new XDomainRequest:null},c={request:function(t){t.method=t.method||"GET";var o=n();o?(o.open(t.method,t.url,!0),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.token?t.auth="Token "+t.token:!t.auth&&t.username&&(t.auth="Basic "+btoa(t.username+":"+t.password||"")),t.auth&&o.setRequestHeader("Authorization",t.auth),"function"==typeof t.onload&&(o.onload=function(){var e=s(o.responseText);401==o.status?"function"==typeof t.onerror&&t.onerror(e,t):t.onload(e)}),"function"==typeof t.onerror&&(o.onerror=function(){t.onerror({status:o.status,error:"undefined error",xhr:o},t)}),o.send(t.data)):"function"==typeof t.fail&&fail()}};o.exports=c}}),Object.assign=function assign(e,t){for(var o,s,n=1;n<arguments.length;++n)for(o in s=arguments[n])Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);return e},cloudsponge.require.define({"v16/authToken":function(e,t,o){function l(e){var t,o=[];for(t in e)o.push(t+"="+encodeURIComponent(e[t]));return o.join("&")}var i=function(e){var t=e.callback,o=e.onerror,s=l(i.authOptions()),n=e.url||cloudsponge.bootstrapper.location.origin+"/api/auth?"+s,c=e.key||cloudsponge.config.key;cloudsponge.require("lib/cors").request({url:n,username:c,password:"",onload:function(e){i.token=e.auth_token,"function"==typeof t&&t(e)},onerror:o})};i.token=null,i.valid=function(){if(!i.token)return!1;var e=i.token.split(".")[1],t=1e3*JSON.parse(atob(e)).exp;return new Date(t)>new Date},i.authOptions=function(){return i.parentOrigin?{parentOrigin:i.parentOrigin}:window!==window.parent?{parentOriginGuess:document.referrer}:{}},i.withValid=function(e,t){i.valid()?e():i.refreshAuthToken(e,t)},i.refreshAuthToken=function(e,t){i({callback:function(){"function"==typeof e&&e()},onerror:t})},o.exports=i}}),cloudspongeUI={},cloudspongeUI.csLogger=function(){function o(){var e=new Date,t=e.getHours()+"",o=e.getMinutes()+"",s=e.getSeconds()+"",n=e.getMilliseconds()+"",c="000";return 1==t.length&&(t="0"+t),1==o.length&&(o="0"+o),1==s.length&&(s="0"+s),t+":"+o+":"+s+"."+(n=c.substring(n.length)+n)}function t(e){return 100*Math.random()<=e}function s(e){if(!cloudsponge.r||!cloudsponge.r.captureException)return!1;switch(e[2]&&e[2].code){case 514:case 516:return t(1);case 263:return!1;default:return!0}}var n="undefined"!=typeof console;return{log:function(){cloudsponge.bootstrapper&&cloudsponge.bootstrapper.debug&&cloudsponge.bootstrapper.debug.match(/true/)&&n&&"undefined"!=typeof console.log?this.log=function(){var e=[].slice.call(arguments,0);e.unshift(location.host+" - "+o()+": ");try{console.log.apply(null,e)}catch(t){}try{cloudsponge.r&&cloudsponge.r.captureBreadcrumb&&cloudsponge.r.captureBreadcrumb({data:e})}catch(t){}return!0}:this.log=function(){},this.log.apply(this,arguments)},debug:function(){var e=[].slice.call(arguments,0);e.unshift("DEBUG:"),this.log.apply(this,e)},info:function(){var e=[].slice.call(arguments,0);e.unshift("INFO:"),this.log.apply(this,e)},warn:function(){if(n&&"undefined"!=typeof console.warn)try{console.warn.apply(null,arguments)}catch(e){}},error:function(){if(n&&"undefined"!=typeof console.error)try{console.error.apply(null,arguments)}catch(t){}try{var e=Array.prototype.slice.apply(arguments);s(e)&&(e=1==e.length?e[0]:JSON.stringify(e),cloudsponge.r.captureException(e))}catch(t){}}}}(),cloudspongeUI.csLogger.info("csLogger present on '"+location.href),cloudspongeUI.oauthRedirect=function(){var e=[];if(window.location){var t=/#?\(_cs_import=([^:]+):([^)]+)\)/,o=location.hash.match(t);o&&(e.push([o[1],o[2]]),window.location.hash=window.location.hash.replace(t,""))}return{execute:function(){0<e.length?cloudsponge.launch.apply(this,e.pop()):cloudsponge.options.autoLaunch&&cloudsponge.launch()}}}(),cloudspongeUI.csBrowserDetect={isMobile:function(){return navigator.userAgent&&navigator.userAgent.match(/Mobile/i)},isWebKit:function(){return navigator.userAgent&&navigator.userAgent.match(/ AppleWebKit\//i)},isAndroid:function(){return navigator.userAgent&&navigator.userAgent.match(/Android/i)}};var authToken=cloudsponge.require("v16/authToken"),cors=cloudsponge.require("lib/cors");CloudspongeCore.API_URL="https://api.cloudsponge.com",CloudspongeCore.METHOD={OAUTH:"OAUTH",CSV:"CSV",VCARD:"VCARD",APPLET:"APPLET",CREDENTIALS:"CREDENTIALS"},CloudspongeCore.ENDPOINTS={OAUTH:"/begin_import/user_consent.json",CSV:"/begin_import/user_consent.json",VCARD:"/begin_import/user_consent.json",APPLET:"/begin_import/desktop_applet.json",CREDENTIALS:"/begin_import/import.json"},CloudspongeCore.EVENT={INITIALIZING:"INITIALIZING",GATHERING:"GATHERING",COMPLETE:"COMPLETE"},CloudspongeCore.STATUS={INPROGRESS:"INPROGRESS",COMPLETED:"COMPLETED",ERROR:"ERROR"},CloudspongeCore.ERROR_TYPE={API:1,CLIENT:2},CloudspongeCore.OAUTH_WINDOW={width:500,height:800,NAME:"CLOUDSPONGE_OAUTH_WINDOW"},CloudspongeCore.APPLET_ID="CLOUDSPONGE_APPLET_CONTAINER",CloudspongeCore.CLIENT_ERRORS={UNSUPPORTED_CORS:{code:1,message:"Your browser does not support CORS",type:CloudspongeCore.ERROR_TYPE.CLIENT},INVALID_SOURCE:{code:2,message:"Invalid source name",type:CloudspongeCore.ERROR_TYPE.CLIENT},INVALID_METHOD:{code:3,message:"Invalid import method",type:CloudspongeCore.ERROR_TYPE.CLIENT},INVALID_SOURCE_METHOD:{code:4,message:"This import method is not supported for the source",type:CloudspongeCore.ERROR_TYPE.CLIENT},UNABLE_TO_GET_IMPORT_ID:{code:5,message:"Unable to get importId from the API",type:CloudspongeCore.ERROR_TYPE.CLIENT},UNABLE_TO_GET_EVENTS:{code:6,message:"Unable to get events from the API",type:CloudspongeCore.ERROR_TYPE.CLIENT},UNABLE_TO_GET_CONTACTS:{code:7,message:"Unable to get contacts from the API",type:CloudspongeCore.ERROR_TYPE.CLIENT},UNABLE_TO_UPLOAD_CSV:{code:8,message:"Unable to upload CSV file",type:CloudspongeCore.ERROR_TYPE.CLIENT},JAVA_NOT_SUPPORTED:{code:9,message:"Your browser does not have Java plugin installed",type:CloudspongeCore.ERROR_TYPE.CLIENT},UNAUTHORIZED_ACCESS:{code:10,message:"HTTP Basic: Access denied. Please check your credentials.",type:CloudspongeCore.ERROR_TYPE.CLIENT}},CloudspongeCore.SOURCES={linkedin:{methods:[CloudspongeCore.METHOD.CSV],"default":CloudspongeCore.METHOD.CSV},csv:{methods:[CloudspongeCore.METHOD.CSV],"default":CloudspongeCore.METHOD.CSV},facebook:{methods:[CloudspongeCore.METHOD.OAUTH],"default":CloudspongeCore.METHOD.OAUTH,oauth_window:{width:420,height:660}},gmail:{methods:[CloudspongeCore.METHOD.OAUTH],"default":CloudspongeCore.METHOD.OAUTH,oauth_window:{width:420,height:660}},icloud:{methods:[CloudspongeCore.METHOD.CREDENTIALS],"default":CloudspongeCore.METHOD.CREDENTIALS},windowslive:{methods:[CloudspongeCore.METHOD.OAUTH],"default":CloudspongeCore.METHOD.OAUTH,oauth_window:{width:470,height:600}},yahoo:{methods:[CloudspongeCore.METHOD.OAUTH],"default":CloudspongeCore.METHOD.OAUTH,oauth_window:{width:420,height:700}},aol:{methods:[CloudspongeCore.METHOD.OAUTH],"default":CloudspongeCore.METHOD.OAUTH,oauth_window:{width:520,height:700}},office365:{methods:[CloudspongeCore.METHOD.OAUTH],"default":CloudspongeCore.METHOD.OAUTH,oauth_window:{width:420,height:485}},outlookcom:{methods:[CloudspongeCore.METHOD.OAUTH],"default":CloudspongeCore.METHOD.OAUTH,oauth_window:{width:420,height:485}},mail_ru:{methods:[CloudspongeCore.METHOD.CREDENTIALS],"default":CloudspongeCore.METHOD.CREDENTIALS},outlook:{methods:[CloudspongeCore.METHOD.CSV,CloudspongeCore.METHOD.APPLET],"default":CloudspongeCore.METHOD.CSV},addressbook:{methods:[CloudspongeCore.METHOD.VCARD,CloudspongeCore.METHOD.APPLET],"default":CloudspongeCore.METHOD.VCARD},uol:{methods:[CloudspongeCore.METHOD.CREDENTIALS],"default":CloudspongeCore.METHOD.CREDENTIALS},bol:{methods:[CloudspongeCore.METHOD.CREDENTIALS],"default":CloudspongeCore.METHOD.CREDENTIALS},terra:{methods:[CloudspongeCore.METHOD.CREDENTIALS],"default":CloudspongeCore.METHOD.CREDENTIALS},rediff:{methods:[CloudspongeCore.METHOD.CREDENTIALS],"default":CloudspongeCore.METHOD.CREDENTIALS},mailcom:{methods:[CloudspongeCore.METHOD.CREDENTIALS],"default":CloudspongeCore.METHOD.CREDENTIALS},gmx:{methods:[CloudspongeCore.METHOD.CREDENTIALS],"default":CloudspongeCore.METHOD.CREDENTIALS},web_de:{methods:[CloudspongeCore.METHOD.CREDENTIALS],"default":CloudspongeCore.METHOD.CREDENTIALS},mail126:{methods:[CloudspongeCore.METHOD.CREDENTIALS],"default":CloudspongeCore.METHOD.CREDENTIALS},mail163:{methods:[CloudspongeCore.METHOD.CREDENTIALS],"default":CloudspongeCore.METHOD.CREDENTIALS},mail_yeah_net:{methods:[CloudspongeCore.METHOD.CREDENTIALS],"default":CloudspongeCore.METHOD.CREDENTIALS},qq_mail:{methods:[CloudspongeCore.METHOD.CSV],"default":CloudspongeCore.METHOD.CSV},poczta_o2:{methods:[CloudspongeCore.METHOD.CREDENTIALS],"default":CloudspongeCore.METHOD.CREDENTIALS},qip_ru:{methods:[CloudspongeCore.METHOD.CREDENTIALS],"default":CloudspongeCore.METHOD.CREDENTIALS},sapo:{methods:[CloudspongeCore.METHOD.CREDENTIALS],"default":CloudspongeCore.METHOD.CREDENTIALS},yandex_ru:{methods:[CloudspongeCore.METHOD.CREDENTIALS],"default":CloudspongeCore.METHOD.CREDENTIALS},naver:{methods:[CloudspongeCore.METHOD.CREDENTIALS],"default":CloudspongeCore.METHOD.CREDENTIALS}},CloudspongeCore.prototype={request:function(t){var e={fail:function(){this._trigger("onError",this._create(CloudspongeCore.CLIENT_ERRORS.UNSUPPORTED_CORS))}.bind(this),onerror:function(e){401===e.status?"Token expired"==e.error?authToken.refreshAuthToken(function(){this.request(t)}.bind(this),this.unauthorizedError.bind(this)):this.unauthorizedError():"function"==typeof t.onerror&&t.onerror(e)}};e.token=e.token||this.jwt||authToken.token,t=Object.assign(e,t),cors.request(t)},unauthorizedError:function(){cloudspongeUI.csLogger.error(CloudspongeCore.CLIENT_ERRORS.UNAUTHORIZED_ACCESS.message),this.popupClose(!0),this._trigger("onError",this._create(CloudspongeCore.CLIENT_ERRORS.UNAUTHORIZED_ACCESS))},start:function(e){this.source=e.source&&e.source.toLowerCase();var t=this.source;t in CloudspongeCore.SOURCES?CloudspongeCore.METHOD.OAUTH===CloudspongeCore.SOURCES[t]["default"]?this["import"](Object.assign({method:CloudspongeCore.SOURCES[t]["default"]},e)):CloudspongeCore.METHOD.CREDENTIALS===CloudspongeCore.SOURCES[t]["default"]?this._trigger("onCredentialStart",t,this._create(CloudspongeCore.CLIENT_ERRORS.UNSUPPORTED_CORS)):this._trigger("onCSVStart",t,this._create(CloudspongeCore.CLIENT_ERRORS.UNSUPPORTED_CORS)):this._trigger("onError",CloudspongeCore.CLIENT_ERRORS.INVALID_SOURCE)},"import":function(e){var t=e.source&&e.source.toLowerCase(),o=e.method;if(t in CloudspongeCore.SOURCES){if(o){if(!(o in CloudspongeCore.METHOD))return void this._trigger("onError",CloudspongeCore.CLIENT_ERRORS.INVALID_METHOD);if(!this._isMethodSupported(t,o))return void this._trigger("onError",CloudspongeCore.CLIENT_ERRORS.INVALID_SOURCE_METHOD);if(o===CloudspongeCore.METHOD.APPLET&&!this._isJavaSupported())return void this._trigger("onError",CloudspongeCore.CLIENT_ERRORS.JAVA_NOT_SUPPORTED)}else o=CloudspongeCore.SOURCES[t]["default"];this._trigger("onInitializingStart",t),this._getImportId(t,o,e)}else this._trigger("onError",CloudspongeCore.CLIENT_ERRORS.INVALID_SOURCE)},cancel:function(){this.canceling=!0,this.pollTimeout&&(clearTimeout(this.pollTimeout),this.pollTimeout=null),this.popupClose()},_getImportId:function(o,s,n){this.source=o&&o.toLowerCase(),this._initializing=!0,s===CloudspongeCore.METHOD.OAUTH&&this._openOauthWin(o);var e=Object.assign({},this.extraOptions,{service:o,username:n.username,password:n.password,redirect_url:this.inlineOauth&&s===CloudspongeCore.METHOD.OAUTH?window.location.toString():"",inlineOauth:this.inlineOauth},authToken.authOptions());authToken.withValid(function(){this.request({method:"POST",url:CloudspongeCore.API_URL+CloudspongeCore.ENDPOINTS[s]+"?_="+(new Date).valueOf(),data:this._getFormData(e),onload:function(e){if(this._trigger("onProgress",o,e.import_id),e.error)return this.popupClose(!0),void this._trigger("onError",e.error);switch(this.jwt=e.token,this.importId=e.import_id,s){case CloudspongeCore.METHOD.OAUTH:var t=this._oauthWin;t&&(t.location=e.url),this._pollOauthPopup();break;case CloudspongeCore.METHOD.CSV:case CloudspongeCore.METHOD.VCARD:case CloudspongeCore.METHOD.APPLET:this._uploadCSV(n.file,e.url);break;case CloudspongeCore.METHOD.CREDENTIALS:this._pollEvents(this.source,this.importId)}}.bind(this),onerror:function(){this.popupClose(!0),this._trigger("onError",CloudspongeCore.CLIENT_ERRORS.UNABLE_TO_GET_IMPORT_ID)}.bind(this)})}.bind(this),this.unauthorizedError.bind(this))},_pollEvents:function(l,i){this.pollTimeout=null,this.request({url:CloudspongeCore.API_URL+"/events/"+i+".json?_="+Math.floor((new Date).valueOf()/1e3),onload:function(e){if(!this.canceling){var t=e.events,o=!0;this._trigger("onEvents",l,t);for(var s=0,n=t.length;s<n;s++){var c=t[s];if(c.event_type==CloudspongeCore.EVENT.GATHERING&&this._initializing&&(this._initializing=!1,this._trigger("onGatheringStarted",l,c)),c.status===CloudspongeCore.STATUS.ERROR)return void this._trigger("onError",{source:l,code:c.value,message:c.description,type:CloudspongeCore.ERROR_TYPE.API});c.status!==CloudspongeCore.STATUS.COMPLETED&&(o=!1)}return this._isOauthAbandoned(t)?(this.logger.info("OAuth window was abandoned"),void this._trigger("onAbandon",l)):o?(this.logger.info("Contacts import complete"),void this._getContacts(l,i)):void(this.pollTimeout=setTimeout(this._pollEvents.bind(this,l,i),1e3))}}.bind(this),onerror:function(){this._trigger("onError",CloudspongeCore.CLIENT_ERRORS.UNABLE_TO_GET_EVENTS)}.bind(this)})},_getContacts:function(t,o){this.request({url:CloudspongeCore.API_URL+"/contacts/"+o+".json",onload:function(e){this.canceling||(e.error?this._trigger("onError",e.error):this._trigger("onContacts",t,e.contacts_owner,e.contacts,o))}.bind(this),onerror:function(){this._trigger("onError",CloudspongeCore.CLIENT_ERRORS.UNABLE_TO_GET_CONTACTS)}.bind(this)})},_uploadCSV:function(e,t){this.request({url:t,method:"POST",data:this._getFormData({csv_file:e},{json:!1}),onload:function(){this._pollEvents(this.source,this.importId)}.bind(this),onerror:function(){this._trigger("onError",CloudspongeCore.CLIENT_ERRORS.UNABLE_TO_UPLOAD_CSV)}.bind(this)})},_appletImport:function(e,t){var o=["<!--[if !IE]> Firefox and others will use outer object -->",'<object classid="java:ContactsApplet" type="application/x-java-applet" archive="'+t+'" height="34" width="150">',"<!-- Konqueror browser needs the following param -->",'<param name="archive" value="'+t+'">','<param name="importId" value="'+e+'">','<param name="leanNetVersionMin" value="4.0">','<param name="forceDotNetImport" value="true">','<param name="MAYSCRIPT" value="true">',"<!--<![endif]-->","<!-- MSIE (Microsoft Internet Explorer) will use inner object -->","<!-- the latest autodownload links for java found here: http://www.oracle.com/technetwork/java/javase/autodownload-140472.html -->",'<object classid="clsid:8AD9C840-044E-11D1-B3E9-00805F499D93" codebase="http://java.sun.com/update/1.7.0/jinstall-7u76-windows-i586.cab" height="0" width="0">','<param name="code" value="ContactsApplet">','<param name="archive" value="'+t+'">','<param name="importId" value="'+e+'">','<param name="leanNetVersionMin" value="4.0">','<param name="forceDotNetImport" value="true">','<param name="MAYSCRIPT" value="true">','<applet archive="'+t+'" code="ContactsApplet" height="200" width="400" mayscript="">','<param name="importId" value="'+e+'">','<param name="leanNetVersionMin" value="4.0">','<param name="forceDotNetImport" value="true">','<param name="MAYSCRIPT" value="true">',"<strong>","This browser does not have a Java Plug-in<br>",'Get the latest Java Plug-in<a href="http://javadl.sun.com/webapps/download/AutoDL?BundleId=47376">here</a>.',"</strong>","</applet>","</object>","<!--[if !IE]> close outer object -->","</object>","<!--<![endif]-->"],s=document.getElementById(CloudspongeCore.APPLET_ID);s||((s=document.createElement("div")).id=CloudspongeCore.APPLET_ID,document.body.appendChild(s)),s.innerHTML=o.join("")},_trigger:function(e){if("function"==typeof this[e])try{this[e].apply(this,[].slice.call(arguments,1))}catch(t){cloudspongeUI.csLogger.error(t)}},_create:function(e){if("function"==typeof Object.create)return Object.create(e);var t=function(){};return t.prototype=e,new t},_isMethodSupported:function(e,t){for(var o=CloudspongeCore.SOURCES[e].methods,s=o.length;s--;)if(o[s]===t)return!0;return!1},_oauthWinActive:function(){try{return this._oauthWin&&!this._oauthWin.closed?(this.logger.info("_oauthWinActive: true",null!==this._oauthWin),!0):(this.logger.info("_oauthWinActive: false",null!==this._oauthWin),!1)}catch(e){return this.logger.error("_oauthWinActive: false",null!==this._oauthWin,e),!1}},popupClose:function(e){try{this._oauthWin&&this._oauthWin.close()}catch(t){this.logger.error("popupClose failed.",t),"TypeError"===t.name&&(this._oauthWin=null)}e||this._trigger("onAbandon")},popupFocus:function(){try{this._oauthWin&&this._oauthWin.focus()}catch(e){this.logger.error("popupFocus failed.",e),"TypeError"===e.name&&(this._oauthWin=null)}},_pollOauthPopup:function(){this.pollTimeout=null,this._oauthWinActive()?this.pollTimeout=setTimeout(this._pollOauthPopup.bind(this),1e3):this._pollEvents(this.source,this.importId)},_openOauthWin:function(e){if(this.inlineOauth)this._oauthWin=window;else{var t=CloudspongeCore.SOURCES[e]&&CloudspongeCore.SOURCES[e].oauth_window||CloudspongeCore.OAUTH_WINDOW,o=t.width;height=t.height;var s=window.outerWidth||document.documentElement.clientWidth,n=window.outerHeight||document.documentElement.clientHeight,c="undefined"==typeof window.screenY?window.screenTop:window.screenY,l=(s-o)/2+("undefined"==typeof window.screenX?window.screenLeft:window.screenX),i=(n-height)/2+c;try{this._oauthWin=window.open("",this.oauthWindowName||CloudspongeCore.OAUTH_WINDOW.NAME,["width="+o,"height="+height,"top="+i,"left="+l].join(",")),this.logger.info("_openOauthWin succeeded",this._oauthWin)}catch(a){this._oauthWin=window,this.inlineOauth=!0,this.logger.warn("_openOauthWin failed",a)}}return this._oauthWin},_isOauthAbandoned:function(e){if(this._oauthWin&&!this._oauthWinActive()){this._oauthWin=null;for(var t=e.length;t--;){var o=e[t];if(o.event_type===CloudspongeCore.EVENT.INITIALIZING&&o.status===CloudspongeCore.STATUS.INPROGRESS)return!0}}return!1},_isJavaSupported:function(){return window.navigator.javaEnabled()&&navigator.mimeTypes["application/x-java-applet"]},_getFormData:function(e,t){t=t||{};var o,s=new FormData;for(var n in e)({}).hasOwnProperty.call(e,n)&&"undefined"!=typeof e[n]&&(o=e[n],!1!==t.json&&"function"!=typeof e[n]&&"string"!=typeof e[n]&&(o=JSON.stringify(o)),s.append(n,o));return s},_parseURLParams:function(){for(var e=window.location.search.slice(1).split("&"),t={},o=0,s=e.length;o<s;o++){var n=e[o].split("=");t[n[0]]=n[1]}return t}},cloudsponge.constants={defaultCSS:"/assets/address_books15-04fa7f6ebf485fbb44e6b3ab4a62f376fa04eb795593bb48cbbcdda3787e29e2.css",themePaths:{"unresponsive-desktop":"/assets/themes/unresponsive-desktop-a0d14335402b606440c7d7c8c37fb361f5c060eb94a17cfca547464be4981076.css",frost:"/assets/themes/frost-6fb4d908ba07fbb9d85834915d1cdc3cae392586fc1cebe5f5ddcc38b7bfe805.css",neon:"/assets/themes/neon-c86e6f112006f3e5b637b670b5133378d6cb264115bd821a92bcd5f9c57a0f05.css",inline:"/assets/themes/inline-288e39809f1ee2efea2af97124fcc93a1dee46718eaa1b53f1b9f91d63161040.css"},localePaths:{"pt-br":"/assets/pt-br-13c0ff20ca0873dca618da7d4d9a9a2b9de6e9d837e494f72c605c3f47d821c8.json",bg:"/assets/bg-5e912abed85a3811ce9815a44d5c806db4c5cf8a6c9c1347cde748563637bd86.json",fr:"/assets/fr-cd1bb51f6b644776e0c6a94c556a45c62322d273bc89640c2170d9062f90b0ef.json",cn:"/assets/cn-d47442000ac16cae80f79d0afc554df20d2fba630111c88bd9adf24dc33a4073.json",cn2:"/assets/cn2-cc2a9fbc426d68806b1fc42c00e9017d0c075f3521be09fa85cb580060f1dc61.json",nl:"/assets/nl-2e9f3ea6e671a3beded64d1ae7c51d1d3c79ab2012b142cb533b9f2f62088a63.json"},trackingId:"UA-10218190-7",utmURL:function(){return"https://www.cloudsponge.com/address-book-widget/?utm_source="+window.location.host+"&utm_medium=cloudsponge-widget&utm_content=cloudsponge-logo&utm_campaign=powered-by-cloudsponge"}},cloudspongeUI.csCollect=function(c,e){function l(e){C.trackingId=e.trackingId,e.name||"",e.alwaysSendReferrer||!1,E.clientId=t()}function i(){return Math.round((new Date).getTime()/1e3)}function s(){function e(){return Math.round(2147483647*Math.random())}function t(e){var t,o,s=1;if(e)for(s=0,o=e.length-1;0<=o;o--)0!=(t=266338304&(s=(s<<6&268435455)+(t=e.charCodeAt(o))+(t<<14)))&&(s^=t>>21);return s}for(var o=window.navigator.userAgent+(document.cookie?document.cookie:"")+(document.referrer?document.referrer:""),s=o.length,n=c.history.length;0<n;)o+=n--^s++;return[e()^2147483647&t(o),i()].join(".")}function t(){var e="CA1.1.",t=document.cookie.match(g+"=([a-z0-9A-Z.]+);");if(t)p=t[1];else{p=p||e+s();var o=new Date;o.setTime(o.getTime()+2592e6),document.cookie=g+"="+p+"; expires="+o.toGMTString()}return p}function n(e,t){e=e||{},t=t||{};for(var o=Object.keys(t),s=0,n=o.length;s<n;s++)e[o[s]]=t[o[s]];return e}function a(e,t){n(t,C),n(t,E),n(t,e),t.hasOwnProperty("page")&&t.page&&t.page.length&&delete t.location;var o={};for(var s in T)t.hasOwnProperty(s)&&null!=t[s]&&t[s]!=undefined&&(o[T[s]]=t[s]);return o}function r(e){var t=[];for(var o in e)e.hasOwnProperty(o)&&t.push(o+"="+encodeURIComponent(e[o]));return t.join("&")}function d(e){var t=new XMLHttpRequest;t.open("GET",e),t.send()}function o(e,t,o){switch(e){case"create":l(t);break;case"set":E[t]=o;break;case"send":var s=a(o,{type:t,timestamp:(new Date).getTime()});if(s.hasOwnProperty("tid")){var n=r(s);d(u+n)}}}var u="https://collect.cloudsponge.com/v1/collect?",p=null,g="_cloudspongea",C={trackingId:""},E={clientId:""},T=(e.location.pathname,e.title,e.referrer?e.referrer:e.location.toString(),{appName:"an",trackingId:"tid",page:"dl",location:"dl",title:"dt",referrer:"dr",dimension1:"k",appVersion:"av",clientId:"cid",type:"t",dimension3:"s",eventCategory:"ec",eventAction:"ea",eventValue:"ev",metric1:"m1",metric2:"m2",timestamp:"ts"});return o.deleteCookie=function(){document.cookie=g+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"},o.captureClientId=function(){t()},o}(window,document),cloudspongeUI.csAnalytics=function(){function o(e,t){e=e||{},t=t||{};for(var o=Object.keys(t),s=0,n=o.length;s<n;s++)e[o[s]]=t[o[s]];return e}function s(){return c()&&window[window.GoogleAnalyticsObject]}function n(){return!!window._gaq}function c(){return!!window.GoogleAnalyticsObject}function l(e,t,o,s,n,c,l){e.GoogleAnalyticsObject=n,e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},e[n].l=1*new Date,c=t.createElement(o),l=t.getElementsByTagName(o)[0],c.async=1,c.src=s,l.parentNode.insertBefore(c,l)}function i(e){try{"function"==typeof cloudspongeUI.csCollect&&cloudspongeUI.csCollect.apply(this,arguments)}catch(o){window.console&&console.error(o)}try{if(c())if("function"==typeof e){var t=e;s().call(this,function(){var e=ga.getByName(d);t.call(this,e)})}else"create"!=e&&(e=d+"."+e),s().apply(this,arguments)}catch(o){window.console&&console.error(o)}}var a=!1,r=["onSourceSelected","onImportComplete","onBeforeDisplayContacts","onContactsSubmitted"],d="cloudsponge",u={info:function(){}};return noTracking=!1,{init:function(e,o){function t(e){function t(e){var t,o,s=1;if(e)for(s=0,o=e.length-1;0<=o;o--)s=0!=(t=266338304&(s=(s<<6&268435455)+(t=e.charCodeAt(o))+(t<<14)))?s^t>>21:s;return s}return e=e||(new Date).valueOf().toString(),!!o&&(!o.hasOwnProperty("loadSampleRate")||t(e)%1e4<=100*o.loadSampleRate)}function s(){noTracking||c()||n()||l(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),opts=e||{},opts.cookieDomain=opts.cookieDomain||"auto",o=o||{},d=opts.name,i("create",opts),i("set","dimension1",o.key),i("set","dimension2",o.version),i("set","appName",o.appName),i("set","appVersion",o.version),opts.alwaysSendReferrer&&i("set","referrer",window.location.toString()),o.loadPage&&(i("set","location",o.loadPage),i("set","title",o.title||"hidden"),t()&&cloudspongeUI.csAnalytics.trackPage(o.loadPage,o.title||"hidden"))}noTracking=o.noTracking,noTracking?cloudspongeUI.csCollect.deleteCookie():(cloudspongeUI.csCollect.captureClientId(),a||(a=!0,o.shared&&"complete"!=document.readyState?window.addEventListener?window.addEventListener("load",function(){s()}):window.attachEvent&&window.attachEvent("onload",s):s()))},trackPage:function(e,t){noTracking||(u.info("Track Page:",[].slice.call(arguments,0)),i("send","pageview",{title:t,page:e}))},trackEvent:function(e,t){noTracking||(u.info("Track Event:",[].slice.call(arguments,0)),r.indexOf(e)<0||("onSourceSelected"==(t=o({eventCategory:"Widget",eventAction:e},t)).eventAction?(i("set","dimension3",t.eventValue),delete t.eventValue):"onImportComplete"==t.eventAction?i("set","metric1",t.eventValue):"onBeforeDisplayContacts"==t.eventAction?t.eventValue?(t.eventValue=1,i("set","dimension4","share enabled")):(t.eventValue=0,i("set","dimension4","share suppressed")):"onContactsSubmitted"==t.eventAction&&i("set","metric2",t.eventValue),i("send","event",t)))}}}(),cloudspongeUI.controller=function(){var o=null,e={displaySelectAllNone:!0,hostUrl:location.toString(),version:cloudsponge.version};return cloudspongeUI.csBrowserDetect.isMobile()&&(e.mobile=!0),{init:function(e){Object.assign(cloudspongeUI.controller.options,cloudsponge.config),Object.assign(cloudspongeUI.controller.options,cloudsponge.initOptions),Object.assign(cloudspongeUI.controller.options,window.csPageOptions),Object.assign(cloudspongeUI.controller.options,cloudsponge.options,e),cloudsponge.options.inlineOauth||(cloudsponge.options.inlineOauth=!1),cloudspongeUI.controller.options&&(cloudspongeUI.controller.options.key||cloudspongeUI.controller.options.domain_key)&&cloudspongeUI.csAnalytics.init({trackingId:cloudsponge.constants.trackingId,name:"cloudspongeHost",alwaysSendReferrer:!0},{key:cloudspongeUI.controller.options.key||cloudspongeUI.controller.options.domain_key,version:cloudsponge.version,appName:"CloudSponge Widget",loadSampleRate:0,shared:!0,logger:cloudspongeUI.csLogger,noTracking:cloudspongeUI.controller.options.noTracking}),"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?csWidget.afterInit():document.addEventListener("DOMContentLoaded",csWidget.afterInit)},realLaunch:function(e,t){return o=new CloudspongeCore({key:cloudsponge.options.key,inlineOauth:!0===cloudsponge.options.inlineOauth||"mobile"===cloudsponge.options.inlineOauth&&cloudsponge.options.mobile,oauthWindowName:cloudsponge.options.oauthWindowName,jwt:t,source:e,logger:cloudspongeUI.csLogger,onProgress:function(e,t){csModel.setProvider(e),csUtils.triggerCallback("beforeImport",e,t),csWidget.onBeforeImport(e)},onCSVStart:function(e){csModel.setProvider(e),csImportView.setOptions(csModel.getSource(e)),csWidget.showImportTab(e),csWidget.showPopup()},onCredentialStart:function(e){csModel.setProvider(e),csLoginView.setOptions(csModel.getSource(e)),csWidget.showLoginTab(e),csWidget.showPopup()},onGatheringStarted:function(e){csUtils.triggerCallback("beforeGathering",e)},onEvents:function(e,t){cloudspongeUI.csLogger.info("EVENTS",e,t)},onError:function(e){csWidget.hideTabs(),csWidget.onAfterImportError(this.source,e.code),csWidget.showPopup(),csUtils.triggerCallback("afterImport",this.source,!1,e.code),cloudspongeUI.csLogger.error("onError",this.source,e)},onAbandon:function(){csWidget.onAfterClosePopup(),csUtils.triggerCallback("afterClosingPopup"),cloudspongeUI.csLogger.info("ABANDON",this.source,"OAUTH popup closed")},onContacts:function(e,t,o,s){var n;csUtils.trackEvent("onImportComplete",{eventValue:o.length}),csUtils.triggerCallback("afterImport",e,!0),o=csUtils.filterNullEmailContacts(o),o=csUtils.applyContactMethods(o),csWidget.closePopup(),csWidget.onBeforeDisplayContacts(o,e,t,!0,s),csWebHooks.beforeDisplayContacts({contacts:o,source:e,owner:t,import_id:s}),n=!1===csUtils.triggerCallback("beforeDisplayContacts",csUtils.copyObj(o),e,csUtils.copyObj(t)),csUtils.trackEvent("onBeforeDisplayContacts",{eventValue:!n}),n||cloudspongeUI.controller.options.skipContactsDisplay?n||csModel.appendToTextArea(o):(csWidget.showPopup(),csWidget.showContactsTab()),(n||cloudspongeUI.controller.options.skipContactsDisplay)&&cloudspongeUI.controller.end()},extraOptions:cloudspongeUI.controller.options}),t?(csModel.setProvider(e),csWidget.onBeforeImport(e)):o.start({source:e}),!1},login:function(e){o["import"]({source:e.source,username:e.username,password:e.password})},upload:function(e){e.file&&o["import"]({source:e.source,file:e.file})},launch:function(e,t,o){var s=null,n=!1;if(!1!==csWidget.beforeLaunch(e))return e?(csUtils.trackEvent("onSourceSelected",{eventValue:e}),(s=csStorage.getSource(e))?(csUtils.trackEvent("onBeforeDisplayContacts"),!1===csUtils.triggerCallback("beforeDisplayContacts",csUtils.copyObj(s.contacts),e,csUtils.copyObj(s.owner))||cloudspongeUI.controller.options.skipContactsDisplay||cloudspongeUI.controller.showContacts(s.contacts,e,s.owner,s.importId)):n=cloudspongeUI.controller.realLaunch(e,t,o)):(csWidget.showBooksTab(),csWidget.showPopup()),n},end:function(){csUtils.triggerCallback("beforeClosing"),csUtils.trackPage("/done","Closed Widget"),csUtils.triggerCallback("afterClosing"),csWidget.onAfterClose(),o&&o.cancel()},showProgress:function(e){csWidget.showLoadingTab(e),csWidget.showPopup()},showContacts:function(e,t,o,s){csModel.setProvider(t),csModel.setOwner(o),csModel.setContacts(e),csModel.setImportId(s),csWidget.showPopup(),csWidget.showContactsTab()},focus:function(){o.popupFocus()},trackPage:function(e,t){cloudspongeUI.csAnalytics.trackPage(e,t)},trackEvent:function(e,t){cloudspongeUI.csAnalytics.trackEvent(e,t)},constants:cloudsponge.constants,options:e,scriptLocation:cloudsponge.bootstrapper.location}}();var CS_LOCALE={ADDRESS_BOOK:"Choose Your Address Book",AUTHORIZATION:"Authenticating",AUTHORIZATION_FOCUS:"Click here to authenticate",SIGN_IN:"Sign in",LOADING_CONTACTS:'<span class="cloudsponge-icon ${provider}"></span> ${name}',SEARCH_CONTACTS:"Search ${name} contacts",SEARCH_SELECTED:"Search selected contacts",NO_SELECTED_CONTACTS:"There are no selected contacts",GET_CONTACTS:"Get ${0} contacts",GET_CONTACTS_MOBILE:"Next",SELECT_CONTACTS:"Select contacts",SELECT_ALL:"Select all (${0})",DESELECT_ALL:"Deselect all (${0})",SELECT_SEARCH:"Select result (${0})",DESELECT_SEARCH:"Deselect result (${0})",REVIEW_SELECTED:"Review Selected (${0})",BACK_TO_LIST:"Back to List",NO_SEARCH_RESULTS:"There are no matched contacts",MORE_MAILS:"+${0} more",MORE_PHONES:"+${0} more",DETAILS_TITLE:"Contact Details",DETAILS_EMAIL:"E-mail",DETAILS_PHONE:"Phone",DETAILS_ADDRESS:"Address",SIGN_IN_ACCOUNT:"Sign in to your account",USERNAME:"Username",PASSWORD:"Password",ENTER_USERNAME:"Please enter your username",ENTER_PASSWORD:"Please enter your password",PRIVACY_NOTICE:"Privacy Notice",
PRIVACY_DISCLAIMER:"We do not store your email address or password information. Your information is submitted securely to retrieve your address book.",IMPORT_CONTACTS:"Import Your Contacts",GET_CSV_CONTACTS:"Get Your ${name} Contacts",EXPORT_CSV:"Click above to export and download your contacts to your computer.<br> You may have to sign in to your account.",DRAG_FILES:"Select and upload your contacts file ",DROP_FILES:"Click to upload your contacts",CHOICE_ANOTHER:"Want to choose another address book?",CLICK_HERE:"click here",NOT_SUPPORTED:"${name} requires contacts upload in CSV file format.<br> This feature is currently supported on our desktop version only.",SELECTION_LIMIT:"Sorry, you cannot select more contacts",DESELECT_CONFIRM:"Are you sure you want to deselect all contacts?",SUGGESTIONS:"Suggestions",STORAGE_LOGGED_AS:"Displaying contacts for ${0}",STORAGE_LAST_UPDATE:"Last updated: ${0}",STORAGE_ENABLED_STATUS:"Caching contacts is enabled",STORAGE_BT_UPDATE_NOW:"Update now",STORAGE_BT_DISABLE_CACHE:"Disable caching",STORAGE_DISABLED_STATUS:"Caching contacts is disabled",STORAGE_BT_ENABLE_CACHE:"Enable caching",UNABLE_LOAD_CONTACTS:'Unable to load ${name} contacts. ${error_message} <br> <a href="javascript:void(0)" id="cloudsponge-error-tryagain">Please try again</a>.',ERROR_258:"<br>Timeout occurred.",ERROR_259:"<br>Username and password are required.",ERROR_262:"<br>The same import failed to authenticate recently.",ERROR_263:"<br>Username and password do not match.",ERROR_264:"<br>The address book is temporarily unavailable, please try again later.",ERROR_265:"<br>This account has been canceled.",ERROR_266:"<br>The account has been blocked. Reset the password to reenable it.",ERROR_267:"<br>Terms of Service have changed for your account. Sign in to your account to enable it.",ERROR_514:"<br>Consent was not given to access your contacts or consent was revoked.",ERROR_516:"<br>Consent was not granted within the allotted time.",ERROR_518:"<br>Unable to communicate successfully with the address book provider.",ERROR_528:"<br>Unable to retrieve contacts. New Yahoo! users must wait 14 days to use this feature.",ERROR_544:"<br>The Gmail developer account is not configured to be able to access the Contacts API.<br>Please review the custom branding.",ERROR_769:"<br>You must trust the applet to import your contacts.",ERROR_770:"<br>No supported contact source was detected on your system.",ERROR_771:"<br>Failed posting contacts to the server.",ERROR_772:"<br>The Desktop Applet was not trusted within the allotted time.",ERROR_774:"<br>You must allow access to Microsoft Outlook to import your contacts. ",ERROR_775:"<br>The application was denied access to Contacts by the OS.",ERROR_1025:"<br>You must upload a valid file.",ERROR_1026:"<br>The file uploaded did not match a valid format.",ERROR_1027:"<br/>File uploads are not supported on the device.",ERROR_UNEXPECTED:"<br>An unexpected error occurred while importing your contacts.",ERROR_RESTART:"<br>Start Over",ERROR_CLOSE:"<br>Dismiss",ERROR_CLOSE:"<br>Dismiss",ERROR_10:"<br>The widget is not authorized. Please verify your site and CloudSponge key",ICLOUD_TWO_STEPS_VERIF:'<strong>Using app-specific passwords</strong><br/>When your Apple ID is protected with two-step verification, or\xa0two-factor authentication, you\'ll need to use an app-specific password to sign in to your account using any apps or services that don\'t support entering verification\xa0codes.<br/>Generate an app-specific password: <a href="https://appleid.apple.com/account/manage" target="_blank" rel="noopener noreferrer">Sign in to your\xa0Apple ID account page</a>.  Follow the steps on your screen.<br/>After you generate your app-specific password, enter or paste it into the password field of the app as you would normally.<br/><a href="https://support.apple.com/HT204397" target="_blank" rel="noopener noreferrer">Learn more about app-specific passwords</a>.'};cloudspongeUI.cs_locale=CS_LOCALE;var csWidgetTemplate={getBase:function(){var e=[];return e.push('<div id="cloudsponge-overlay" style="display:none"></div>','<div id="cloudsponge-address-book" style="display:none">',"${0}"),cloudspongeUI.controller.options._hideBranding||e.push('<div class="cloudsponge-copyright">powered by <a href="'+cloudspongeUI.controller.constants.utmURL()+'" target="_blank" rel="nofollow noopener noreferrer"><span>CloudSponge</span></a></div>'),e.push("</div>"),e.join("")},getLoadingTab:function(){var e=[];return e.push('<div id="cloudsponge-loading-tab" class="cloudsponge-widget">','<div class="cloudsponge-topbar">','<a class="cloudsponge-button cloudsponge-back-button" href="javascript:void(0)">','<em class="cloudsponge-glyph back-arrow"></em>',"</a>",'<div class="cloudsponge-h1">${title}</div>','<a class="cloudsponge-close-button" href="javascript:void(0)"><em class="cloudsponge-glyph cross"></em></a>',"</div>",'<div id="cloudsponge-loading-overlay">','<em id="cloudsponge-loader">','<span id="cloudsponge-loader-text" class="cloudsponge-loading-text"></span>','<span id="cloudsponge-loading-gif" class="cloudsponge-loading-gif"></span>','<span id="cloudsponge-oauth-focus-span"><a id="cloudsponge-oauth-focus" href="javascript:void(0)">${oauthFocus}</a></span>',"</em>","</div>","</div>"),e.join("")},getLoginTab:function(){var e=[];return e.push('<div id="cloudsponge-login-tab" class="cloudsponge-widget">','<div class="cloudsponge-topbar">','<a class="cloudsponge-button cloudsponge-back-button" href="javascript:void(0)">','<em class="cloudsponge-glyph back-arrow"></em>',"</a>",'<div class="cloudsponge-h1">${title}</div>','<a class="cloudsponge-close-button" href="javascript:void(0)"><em class="cloudsponge-glyph cross"></em></a>',"</div>",'<div class="cloudsponge-login">','<form id="cloudsponge-login-form" class="cloudsponge-login-form" action="" target="cs_container_frame" method="post">','<div class="cloudsponge-h2">','<em id="cloudsponge-source-icon" class="cloudsponge-icon"></em> <em id="cloudsponge-source-name"></em>',"<span>${signInAccount}</span>","</div>",'<p id="cloudsponge-login-error" class="cloudsponge-error"></p>','<p><input id="cloudsponge-login-user" type="text" name="user" placeholder="${username}"></p>','<p><input id="cloudsponge-login-password" type="password" name="pass" placeholder="${password}"></p>',"<p>",'<input id="cloudsponge-source-value" type="hidden" name="source">','<input type="submit" value="${signIn}">',"</p>",'<p id="cloudsponge-icloud-two-steps-verification-message" style="display:none">${icloud_two_steps_verif}</p>','<p id="cloudsponge-login-back">',"${choiceAnother}<br>",'<a href="javascript:void(0)" class="cloudsponge-desktop-back-button">${clickHere}</a>',"</p>","</form>",'<p class="cloudsponge-disclaimer">',"<span>${privacyNotice}</span>","${privacyDisclaimer}","</p>","</div>","</div>"),e.join("")},getImportTab:function(){var e=[];return e.push('<div id="cloudsponge-import-tab" class="cloudsponge-widget">','<div class="cloudsponge-topbar">','<a class="cloudsponge-button cloudsponge-back-button" href="javascript:void(0)">','<em class="cloudsponge-glyph back-arrow"></em>',"</a>",'<div class="cloudsponge-h1">${title}</div>','<a class="cloudsponge-close-button" href="javascript:void(0)"><em class="cloudsponge-glyph cross"></em></a>',"</div>",'<div class="cloudsponge-import">','<form id="cloudsponge-import-form" class="cloudsponge-import-form" action="" method="POST" enctype="multipart/form-data">','<div class="cloudsponge-csv-generic" style="display:none;">','<em id="cloudsponge-provider-icon-generic" class="cloudsponge-csv-generic cloudsponge-provider cloudsponge-icon csv"></em>',"</div>",'<div class="cloudsponge-step-row cloudsponge-csv-specific">','<span class="cloudsponge-step-number">1</span>','<a id="cloudsponge-csv-export" class="cloudsponge-save-button" target="_blank" rel="noopener noreferrer" href="javascript:void(0)"><em id="cloudsponge-csv-icon" class="cloudsponge-icon"></em> <span id="cloudsponge-csv-contacts"></span></a>',"<p>${exportCSV}</p>","</div>",'<div class="cloudsponge-step-row">','<span class="cloudsponge-step-number cloudsponge-csv-specific">2</span>',"<p>${dragFiles}</p>",'<div id="cloudsponge-file-upload" class="cloudsponge-file-upload">',"${dropFiles}","</div>",'<input id="cloudsponge-file-upload-input" type="file" name="csv_file" accept="text/csv|text/vcard">',"</div>",'<div id="cloudsponge-import-back" class="cloudsponge-step-row cloudsponge-description">','${choiceAnother} <a class="cloudsponge-desktop-back-button" href="javascript:void(0)">${goBack}</a>',"</div>",'<div class="cloudsponge-not-supported" id="cloudsponge-csv-not-supported">',"</div>","</form>","</div>","</div>"),e.join("")},getAddressBooksTab:function(){var e=[];return e.push('<div id="cloudsponge-books-tab" class="cloudsponge-widget">','<div class="cloudsponge-topbar">','<a class="cloudsponge-button cloudsponge-back-button cloudsponge-back-close" href="javascript:void(0)">','<em class="cloudsponge-glyph back-arrow"></em>',"</a>",'<div class="cloudsponge-h1">${title}</div>','<a class="cloudsponge-close-button" href="javascript:void(0)"><em class="cloudsponge-glyph cross"></em></a>',"</div>",'<div class="cloudsponge-providers-holder">','<ul id="cloudsponge-providers-list" class="cloudsponge-providers-list">',"${items}","</ul>","</div>","</div>"),e.join("")},getBooksEntry:function(){return'<li class="${addClass}" data-launcher="${launcher}"><a href="javascript:void(0)"><em class="cloudsponge-icon ${className}"></em> ${name}</a></li>'},getContactsManagerTab:function(){var e=[];return e.push('<div id="cloudsponge-contacts-tab" class="cloudsponge-widget">','<div class="cloudsponge-topbar">','<a class="cloudsponge-button cloudsponge-back-button" href="javascript:void(0)">','<em class="cloudsponge-glyph back-arrow"></em>',"</a>",'<div class="cloudsponge-h1">${title}</div>','<a class="cloudsponge-close-button" href="javascript:void(0)"><em class="cloudsponge-glyph cross"></em></a>',"</div>",'<div id="cloudsponge-contacts-manager">','<div id="cloudsponge-search-bar" class="cloudsponge-header">','<div class="cloudsponge-input-holder">','<em id="cloudsponge-provider-icon" data-base-class="cloudsponge-provider cloudsponge-icon"></em>','<em class="cloudsponge-separator"></em>','<em class="cloudsponge-glyph search"></em>','<input id="cloudsponge-search-contacts" type="text" class="cloudsponge-input" placeholder="${search_contacts}">','<input id="cloudsponge-search-booked" type="text" class="cloudsponge-input" placeholder="${search_selected}">','<a id="cloudsponge-contacts-search-close" class="cloudsponge-close-search" href="javascript:void(0)">','<em class="cloudsponge-glyph cross"></em>',"</a>",'<a id="cloudsponge-booked-search-close" class="cloudsponge-close-search" href="javascript:void(0)">','<em class="cloudsponge-glyph cross"></em>',"</a>","</div>","</div>",'<div id="cloudsponge-contacts-title" class="cloudsponge-title">','<a id="cloudsponge-select-all" class="cloudsponge-left-link" href="javascript:void(0)">${select_all}</a>','<a id="cloudsponge-deselect-all" class="cloudsponge-left-link" href="javascript:void(0)">${deselect_all}</a>','<a id="cloudsponge-select-search" class="cloudsponge-left-link" href="javascript:void(0)">${select_search}</a>','<a id="cloudsponge-deselect-search" class="cloudsponge-left-link" href="javascript:void(0)">${deselect_search}</a>','<a id="cloudsponge-review-booked" href="javascript:void(0)">${review_booked}</a>','<a id="cloudsponge-back-to-list" href="javascript:void(0)">${back_to_list}</a>',"</div>",'<div class="cloudsponge-contacts-content">','<div class="cloudsponge-cell">','<div class="cloudsponge-cell-holder">','<div id="cloudsponge-contacts-scrolling-region">','<div id="cloudsponge-no-search-results" class="cloudsponge-message">${no_search_results}</div>','<div id="cloudsponge-no-selected-contacts" class="cloudsponge-message">${no_selected_contacts}</div>','<ul id="cloudsponge-contacts-list" class="cloudsponge-contacts-list"></ul>','<div class="cloudsponge-storage-message"></div>','<div class="cloudsponge-copyright-item"></div>',"</div>",'<div id="cloudsponge-dictionary" class="cloudsponge-dictionary">',"${dict_items}","</div>",'<em id="cloudsponge-letter-preview" class="cloudsponge-letter-preview"></em>',"</div>","</div>","</div>",'<a id="cloudsponge-export-button" class="cloudsponge-button cloudsponge-export-button" href="javascript:void(0)">','<span id="cloudsponge-get-contacts" class="cloudsponge-desktop-export">${get_contacts}</span> ','<span id="cloudsponge-get-contacts-mobile" class="cloudsponge-mobile-export test">${get_contacts_mobile}</span>','<em class="cloudsponge-glyph forward-arrow"></em>',"</a>","</div>","</div>"),e.join("")},getMoreButton:function(){var e=[];return e.push('<div data-type="more" class="cloudsponge-js-more cloudsponge-mobile-detail">','<div class="cloudsponge-mobile-detail-more"></div>',"</div>"),e.join("")},getContact:function(){var e=[];return e.push("<li ",'data-index="${index}" ','data-type="contact"',' class="cloudsponge-contact-item ${class_name} ${unknown_class}"',">","${more_button}"),cloudspongeUI.controller.options.displayContactsColumns&&-1!==cloudspongeUI.controller.options.displayContactsColumns.indexOf("phone")?e.push("<select ${phone_disabled}>","${OPTION_PHONE}","</select>"):cloudspongeUI.controller.options.displayContactsColumns&&-1!==cloudspongeUI.controller.options.displayContactsColumns.indexOf("mailing_address")&&e.push("<select ${address_disabled}>","${OPTION_ADDRESS}","</select>"),e.push("<select ${disabled}>","${OPTION_EMAIL}","</select>"),e.push('<div class="cloudsponge-row-container">','<input ${checked} id="contact-${index}" type="checkbox">','<label for="contact-${index}" class="cloudsponge-glyph cloudsponge-checkbox"></label>','<div class="cloudsponge-h3">${name}</div>','<span class="cloudsponge-selected-mail ${multiple_class}">','<span class="cloudsponge-mail-label" title=${email}>${formatted_email}</span>','<em class="cloudsponge-glyph down-arrow"></em>','<em class="cloudsponge-more-mails">${plus_contacts}</em>','<ul class="cloudsponge-mail-dropdown">',"${CONTACT_EMAIL}","</ul>","</span>"),cloudspongeUI.controller.options.displayContactsColumns&&-1!==cloudspongeUI.controller.options.displayContactsColumns.indexOf("phone")?e.push('<span class="cloudsponge-selected-phone ${multiple_phone_class}">','<span class="cloudsponge-phone-label" title="${phone}">${phone}</span>','<em class="cloudsponge-glyph down-arrow"></em>','<em class="cloudsponge-more-phones">${plus_phone}</em>','<ul class="cloudsponge-phone-dropdown">',"${CONTACT_PHONE}","</ul>","</span>"):cloudspongeUI.controller.options.displayContactsColumns&&-1!==cloudspongeUI.controller.options.displayContactsColumns.indexOf("mailing_address")&&e.push('<span class="cloudsponge-selected-address ${multiple_address_class}">','<span class="cloudsponge-address-label" title="${address}">${address}</span>','<em class="cloudsponge-glyph down-arrow"></em>','<em class="cloudsponge-more-addresses">${plus_addresses}</em>','<ul class="cloudsponge-address-dropdown">',"${CONTACT_ADDRESS}","</ul>","</span>"),e.push("</div>","</li>"),e.join("")},getCopyright:function(){var e=[];return cloudspongeUI.controller.options._hideBranding||e.push('<a href="'+cloudspongeUI.controller.constants.utmURL()+'" target="_blank" rel="nofollow noopener noreferrer">Powered by CloudSponge</a>'),e.join("")},getLetter:function(){var e=[];return e.push('<li id="cloudsponge-letter-${letter}" class="cloudsponge-letter">',"${letter}","</li>"),e.join("")},getEmail:function(){var e=[];return e.push("<li",' data-type="option"',' data-mail="${email}"',' data-index="${index}"',">","${email}","</li>"),e.join("")},getOptionEmail:function(){var e=[];return e.push("<option"," ${selected}",' data-mail="${email}"',' data-primary="${primary}"',' data-type="${type}"',' data-index="${index}"',">","${email}","</option>"),e.join("")},getPhone:function(){var e=[];return e.push("<li",' data-type="option"',' data-phone="${phone}"',' data-index="${index}"',">","${phone}","</li>"),e.join("")},getOptionPhone:function(){var e=[];return e.push("<option"," ${selected}",' data-phone="${phone}"',' data-type="${type}"',' data-index="${index}"',">","${phone}","</option>"),e.join("")},getAddress:function(){var e=[];return e.push("<li",' data-type="option"',' data-address="${address}"',' data-index="${index}"',">","${address}","</li>"),e.join("")},getOptionAddress:function(){var e=[];return e.push("<option"," ${selected}",' data-address="${address}"',' data-type="${type}"',' data-index="${index}"',">","${address}","</option>"),e.join("")},getDictionary:function(){for(var e=[],t=[],o="A".charCodeAt(),s=0;s<26;s++)t.push(String.fromCharCode(s+o));t.push("#");s=0;for(var n=t.length;s<n;s++)e.push('<a href="javascript:void(0)" data-for="cloudsponge-letter-'+t[s].toLowerCase()+'">'+t[s]+"</a>");return e.join("")},getStorageMessage:function(){return html=[],html.push('<div id="cloudsponge-storage-logged-user">${logged_as}</div>','<div id="cloudsponge-storage-last-updated">',"${last_update}",'<a href="javascript:void(0)" id="cloudsponge-storage-update">${update_now}</a>',"</div>",'<div id="cloudsponge-storage-status-enabled">',"${storage_enabled_status}",'<a href="javascript:void(0)" id="cloudsponge-storage-disable">${disable_cache}</a>',"</div>",'<div id="cloudsponge-storage-status-disabled">',"${storage_disabled_status}",'<a href="javascript:void(0)" id="cloudsponge-storage-enable">${enable_cache}</a>',"</div>"),html.join("")},getContactDetails:function(){return html=[],html.push('<div id="cloudsponge-details-tab" class="cloudsponge-widget">','<div class="cloudsponge-topbar">','<a class="cloudsponge-button cloudsponge-back-button" href="javascript:void(0)">','<em class="cloudsponge-glyph back-arrow"></em>',"</a>",'<div class="cloudsponge-h1">${title}</div>','<a class="cloudsponge-close-button" href="javascript:void(0)"><em class="cloudsponge-glyph cross"></em></a>',"</div>",'<div class="cloudsponge-contact-details">','<div class="cloudsponge-h3">${name}</div>','<div class="cloudsponge-details">','<div class="cloudsponge-email-field">','<div class="cloudsponge-field-label">',"<label>${email_label}</label>","</div>",'<div class="cloudsponge-field-select">','<select class="cloudsponge-email-select" data-index=${id}>',"${OPTION_EMAIL}","</select>","</div>","</div>"),cloudsponge.options.displayContactsColumns&&-1!==cloudsponge.options.displayContactsColumns.indexOf("phone")?html.push('<div class="cloudsponge-phone-field">','<div class="cloudsponge-field-label">',"<label>${phone_label}</label>","</div>",'<div class="cloudsponge-field-select">','<select class="cloudsponge-phone-select" data-index=${id}>',"${OPTION_PHONE}","</select>","</div>","</div>"):cloudsponge.options.displayContactsColumns&&-1!==cloudsponge.options.displayContactsColumns.indexOf("mailing_address")&&html.push('<div class="cloudsponge-address-field">','<div class="cloudsponge-field-label">',"<label>${address_label}</label>","</div>",'<div class="cloudsponge-field-select">','<select class="cloudsponge-address-select" data-index=${id}>',"${OPTION_ADDRESS}","</select>","</div>","</div>"),html.push("</div>","</div>","</div>"),html.join("")}};cloudspongeUI.widget_template=csWidgetTemplate;var csContactsTemplate={getName:function(){var e=[];return e.push("${name}"),e.join("")},getEmail:function(){var e=[];return e.push("${email}"),e.join("")},getNameEmail:function(){var e=[];return e.push("${name} <${email}>"),e.join("")},getNamePhone:function(){var e=[];return e.push("${name}: ${phone}"),e.join("")},getNameEmailPhone:function(){var e=[];return e.push("${name} <${email}>: ${phone}"),e.join("")},getNameEmailAddress:function(){var e=[];return e.push("${name} <${email}>: ${address}"),e.join("")}};cloudspongeUI.contacts_template=csContactsTemplate;var csUtils=function(){var t=function(){var e,t,o,s=[{base:"A",letters:"A\u24b6\uff21\xc0\xc1\xc2\u1ea6\u1ea4\u1eaa\u1ea8\xc3\u0100\u0102\u1eb0\u1eae\u1eb4\u1eb2\u0226\u01e0\xc4\u01de\u1ea2\xc5\u01fa\u01cd\u0200\u0202\u1ea0\u1eac\u1eb6\u1e00\u0104\u023a\u2c6f"},{base:"AA",letters:"\ua732"},{base:"AE",letters:"\xc6\u01fc\u01e2"},{base:"AO",letters:"\ua734"},{base:"AU",letters:"\ua736"},{base:"AV",letters:"\ua738\ua73a"},{base:"AY",letters:"\ua73c"},{base:"B",letters:"B\u24b7\uff22\u1e02\u1e04\u1e06\u0243\u0182\u0181"},{base:"C",letters:"C\u24b8\uff23\u0106\u0108\u010a\u010c\xc7\u1e08\u0187\u023b\ua73e"},{base:"D",letters:"D\u24b9\uff24\u1e0a\u010e\u1e0c\u1e10\u1e12\u1e0e\u0110\u018b\u018a\u0189\ua779"},{base:"DZ",letters:"\u01f1\u01c4"},{base:"Dz",letters:"\u01f2\u01c5"},{base:"E",letters:"E\u24ba\uff25\xc8\xc9\xca\u1ec0\u1ebe\u1ec4\u1ec2\u1ebc\u0112\u1e14\u1e16\u0114\u0116\xcb\u1eba\u011a\u0204\u0206\u1eb8\u1ec6\u0228\u1e1c\u0118\u1e18\u1e1a\u0190\u018e"},{base:"F",letters:"F\u24bb\uff26\u1e1e\u0191\ua77b"},{base:"G",letters:"G\u24bc\uff27\u01f4\u011c\u1e20\u011e\u0120\u01e6\u0122\u01e4\u0193\ua7a0\ua77d\ua77e"},{base:"H",letters:"H\u24bd\uff28\u0124\u1e22\u1e26\u021e\u1e24\u1e28\u1e2a\u0126\u2c67\u2c75\ua78d"},{base:"I",letters:"I\u24be\uff29\xcc\xcd\xce\u0128\u012a\u012c\u0130\xcf\u1e2e\u1ec8\u01cf\u0208\u020a\u1eca\u012e\u1e2c\u0197"},{base:"J",letters:"J\u24bf\uff2a\u0134\u0248"},{base:"K",letters:"K\u24c0\uff2b\u1e30\u01e8\u1e32\u0136\u1e34\u0198\u2c69\ua740\ua742\ua744\ua7a2"},{base:"L",letters:"L\u24c1\uff2c\u013f\u0139\u013d\u1e36\u1e38\u013b\u1e3c\u1e3a\u0141\u023d\u2c62\u2c60\ua748\ua746\ua780"},{base:"LJ",letters:"\u01c7"},{base:"Lj",letters:"\u01c8"},{base:"M",letters:"M\u24c2\uff2d\u1e3e\u1e40\u1e42\u2c6e\u019c"},{base:"N",letters:"N\u24c3\uff2e\u01f8\u0143\xd1\u1e44\u0147\u1e46\u0145\u1e4a\u1e48\u0220\u019d\ua790\ua7a4"},{base:"NJ",letters:"\u01ca"},{base:"Nj",letters:"\u01cb"},{base:"O",letters:"O\u24c4\uff2f\xd2\xd3\xd4\u1ed2\u1ed0\u1ed6\u1ed4\xd5\u1e4c\u022c\u1e4e\u014c\u1e50\u1e52\u014e\u022e\u0230\xd6\u022a\u1ece\u0150\u01d1\u020c\u020e\u01a0\u1edc\u1eda\u1ee0\u1ede\u1ee2\u1ecc\u1ed8\u01ea\u01ec\xd8\u01fe\u0186\u019f\ua74a\ua74c"},{base:"OI",letters:"\u01a2"},{base:"OO",letters:"\ua74e"},{base:"OU",letters:"\u0222"},{base:"OE",letters:"\x8c\u0152"},{base:"oe",letters:"\x9c\u0153"},{base:"P",letters:"P\u24c5\uff30\u1e54\u1e56\u01a4\u2c63\ua750\ua752\ua754"},{base:"Q",letters:"Q\u24c6\uff31\ua756\ua758\u024a"},{base:"R",letters:"R\u24c7\uff32\u0154\u1e58\u0158\u0210\u0212\u1e5a\u1e5c\u0156\u1e5e\u024c\u2c64\ua75a\ua7a6\ua782"},{base:"S",letters:"S\u24c8\uff33\u1e9e\u015a\u1e64\u015c\u1e60\u0160\u1e66\u1e62\u1e68\u0218\u015e\u2c7e\ua7a8\ua784"},{base:"T",letters:"T\u24c9\uff34\u1e6a\u0164\u1e6c\u021a\u0162\u1e70\u1e6e\u0166\u01ac\u01ae\u023e\ua786"},{base:"TZ",letters:"\ua728"},{base:"U",letters:"U\u24ca\uff35\xd9\xda\xdb\u0168\u1e78\u016a\u1e7a\u016c\xdc\u01db\u01d7\u01d5\u01d9\u1ee6\u016e\u0170\u01d3\u0214\u0216\u01af\u1eea\u1ee8\u1eee\u1eec\u1ef0\u1ee4\u1e72\u0172\u1e76\u1e74\u0244"},{base:"V",letters:"V\u24cb\uff36\u1e7c\u1e7e\u01b2\ua75e\u0245"},{base:"VY",letters:"\ua760"},{base:"W",letters:"W\u24cc\uff37\u1e80\u1e82\u0174\u1e86\u1e84\u1e88\u2c72"},{base:"X",letters:"X\u24cd\uff38\u1e8a\u1e8c"},{base:"Y",letters:"Y\u24ce\uff39\u1ef2\xdd\u0176\u1ef8\u0232\u1e8e\u0178\u1ef6\u1ef4\u01b3\u024e\u1efe"},{base:"Z",letters:"Z\u24cf\uff3a\u0179\u1e90\u017b\u017d\u1e92\u1e94\u01b5\u0224\u2c7f\u2c6b\ua762"},{base:"a",letters:"a\u24d0\uff41\u1e9a\xe0\xe1\xe2\u1ea7\u1ea5\u1eab\u1ea9\xe3\u0101\u0103\u1eb1\u1eaf\u1eb5\u1eb3\u0227\u01e1\xe4\u01df\u1ea3\xe5\u01fb\u01ce\u0201\u0203\u1ea1\u1ead\u1eb7\u1e01\u0105\u2c65\u0250"},{base:"aa",letters:"\ua733"},{base:"ae",letters:"\xe6\u01fd\u01e3"},{base:"ao",letters:"\ua735"},{base:"au",letters:"\ua737"},{base:"av",letters:"\ua739\ua73b"},{base:"ay",letters:"\ua73d"},{base:"b",letters:"b\u24d1\uff42\u1e03\u1e05\u1e07\u0180\u0183\u0253"},{base:"c",letters:"c\u24d2\uff43\u0107\u0109\u010b\u010d\xe7\u1e09\u0188\u023c\ua73f\u2184"},{base:"d",letters:"d\u24d3\uff44\u1e0b\u010f\u1e0d\u1e11\u1e13\u1e0f\u0111\u018c\u0256\u0257\ua77a"},{base:"dz",letters:"\u01f3\u01c6"},{base:"e",letters:"e\u24d4\uff45\xe8\xe9\xea\u1ec1\u1ebf\u1ec5\u1ec3\u1ebd\u0113\u1e15\u1e17\u0115\u0117\xeb\u1ebb\u011b\u0205\u0207\u1eb9\u1ec7\u0229\u1e1d\u0119\u1e19\u1e1b\u0247\u025b\u01dd"},{base:"f",letters:"f\u24d5\uff46\u1e1f\u0192\ua77c"},{base:"g",letters:"g\u24d6\uff47\u01f5\u011d\u1e21\u011f\u0121\u01e7\u0123\u01e5\u0260\ua7a1\u1d79\ua77f"},{base:"h",letters:"h\u24d7\uff48\u0125\u1e23\u1e27\u021f\u1e25\u1e29\u1e2b\u1e96\u0127\u2c68\u2c76\u0265"},{base:"hv",letters:"\u0195"},{base:"i",letters:"i\u24d8\uff49\xec\xed\xee\u0129\u012b\u012d\xef\u1e2f\u1ec9\u01d0\u0209\u020b\u1ecb\u012f\u1e2d\u0268\u0131"},{base:"j",letters:"j\u24d9\uff4a\u0135\u01f0\u0249"},{base:"k",letters:"k\u24da\uff4b\u1e31\u01e9\u1e33\u0137\u1e35\u0199\u2c6a\ua741\ua743\ua745\ua7a3"},{base:"l",letters:"l\u24db\uff4c\u0140\u013a\u013e\u1e37\u1e39\u013c\u1e3d\u1e3b\u017f\u0142\u019a\u026b\u2c61\ua749\ua781\ua747"},{base:"lj",letters:"\u01c9"},{base:"m",letters:"m\u24dc\uff4d\u1e3f\u1e41\u1e43\u0271\u026f"},{base:"n",letters:"n\u24dd\uff4e\u01f9\u0144\xf1\u1e45\u0148\u1e47\u0146\u1e4b\u1e49\u019e\u0272\u0149\ua791\ua7a5"},{base:"nj",letters:"\u01cc"},{base:"o",letters:"o\u24de\uff4f\xf2\xf3\xf4\u1ed3\u1ed1\u1ed7\u1ed5\xf5\u1e4d\u022d\u1e4f\u014d\u1e51\u1e53\u014f\u022f\u0231\xf6\u022b\u1ecf\u0151\u01d2\u020d\u020f\u01a1\u1edd\u1edb\u1ee1\u1edf\u1ee3\u1ecd\u1ed9\u01eb\u01ed\xf8\u01ff\u0254\ua74b\ua74d\u0275"},{base:"oi",letters:"\u01a3"},{base:"ou",letters:"\u0223"},{base:"oo",letters:"\ua74f"},{base:"p",letters:"p\u24df\uff50\u1e55\u1e57\u01a5\u1d7d\ua751\ua753\ua755"},{base:"q",letters:"q\u24e0\uff51\u024b\ua757\ua759"},{base:"r",letters:"r\u24e1\uff52\u0155\u1e59\u0159\u0211\u0213\u1e5b\u1e5d\u0157\u1e5f\u024d\u027d\ua75b\ua7a7\ua783"},{base:"s",letters:"s\u24e2\uff53\xdf\u015b\u1e65\u015d\u1e61\u0161\u1e67\u1e63\u1e69\u0219\u015f\u023f\ua7a9\ua785\u1e9b"},{base:"t",letters:"t\u24e3\uff54\u1e6b\u1e97\u0165\u1e6d\u021b\u0163\u1e71\u1e6f\u0167\u01ad\u0288\u2c66\ua787"},{base:"tz",letters:"\ua729"},{base:"u",letters:"u\u24e4\uff55\xf9\xfa\xfb\u0169\u1e79\u016b\u1e7b\u016d\xfc\u01dc\u01d8\u01d6\u01da\u1ee7\u016f\u0171\u01d4\u0215\u0217\u01b0\u1eeb\u1ee9\u1eef\u1eed\u1ef1\u1ee5\u1e73\u0173\u1e77\u1e75\u0289"},{base:"v",letters:"v\u24e5\uff56\u1e7d\u1e7f\u028b\ua75f\u028c"},{base:"vy",letters:"\ua761"},{base:"w",letters:"w\u24e6\uff57\u1e81\u1e83\u0175\u1e87\u1e85\u1e98\u1e89\u2c73"},{base:"x",letters:"x\u24e7\uff58\u1e8b\u1e8d"},{base:"y",letters:"y\u24e8\uff59\u1ef3\xfd\u0177\u1ef9\u0233\u1e8f\xff\u1ef7\u1e99\u1ef5\u01b4\u024f\u1eff"},{base:"z",letters:"z\u24e9\uff5a\u017a\u1e91\u017c\u017e\u1e93\u1e95\u01b6\u0225\u0240\u2c6c\ua763"}],n={};for(t=0;t<s.length;t++)for(e=s[t].letters,o=0;o<e.length;o++)n[e[o]]=s[t].base;return n}();return{getOption:function(e){if("undefined"!=typeof cloudspongeUI.controller.options)return cloudspongeUI.controller.options[e]},mixin:function(e,t){e=e||{},t=t||{};for(var o=Object.keys(t),s=0,n=o.length;s<n;s++)e[o[s]]=t[o[s]];return e},triggerCallback:function(e){var t;if(cloudspongeUI.csLogger.info("Callback triggered:",[].slice.call(arguments,0)),"function"==typeof cloudspongeUI.controller.options[e])try{t=cloudspongeUI.controller.options[e].apply(null,[].slice.call(arguments,1))}catch(o){cloudspongeUI.csLogger.error(o)}return t},trackPage:function(e,t){cloudspongeUI.controller.trackPage(e,t)},trackEvent:function(e,t){if(cloudspongeUI.controller.options.gaTrackEvents&&"function"==typeof ga)try{ga("send",csUtils.mixin({hitType:"event",eventCategory:"CloudSponge Widget",eventAction:e},t))}catch(o){cloudspongeUI.csLogger.error(o)}cloudspongeUI.controller.trackEvent(e,t)},truncate:function(e,t){return e.length>t?e.slice(0,t)+"...":e},fillStr:function(e,t){for(var o,s="",n=0,c=0;-1<(o=e.indexOf("${",++o));)if(s+=e.slice(n,o),n=e.indexOf("}",o)+1){var l=e.slice(o+2,n-1);"undefined"!=typeof t[l]?s+=t[l]:"undefined"!=typeof t[c]?s+=t[c]:s+="${"+l+"}",c++}else n=o;return s+=e.slice(n)},setHTML:function(e,t){if(e.length)for(var o in e)e[o].innerHTML=t;else e.innerHTML=t},getById:function(e){return document.getElementById(e)},getByClassName:function(e,t){var o=e,s=1,n=[];"string"==typeof o&&(s=0,o=document);for(var c=arguments.length;s<c;s++)n.push.apply(n,[].slice.call(o.getElementsByClassName(arguments[s])));return n},getBySel:function(e,t){return"string"==typeof e?document.querySelectorAll(e):e.querySelectorAll(t)},getByTag:function(e,t){return"string"==typeof e?document.getElementsByTagName(e):e.getElementsByTagName(t)},getText:function(e){return e.textContent||e.innerText},showElement:function(e){"string"==typeof e&&(e=csUtils.getById(e)),e.style.display=""},hideElement:function(e){"string"==typeof e&&(e=csUtils.getById(e)),e.style.display="none"},isHidden:function(e){return"none"==e.style.display},scrollElementY:function(e,t,o){var s=e.scrollTop,n=Math.abs(t-s),c=Math.ceil(n/10);t<s?function l(){s-=c,e.scrollTop=s,t<s?setTimeout(l,10):(e.scrollTop=t,o())}():function l(){s+=c,(e.scrollTop=s)<t?setTimeout(l,10):(e.scrollTop=t,o())}()},delegate:function(o,s){return function(e){for(var t=e.target;this!==t&&!o(t);)t=t.parentNode;this!==t&&s.call(t,e)}},trim:function(e){return null!=e?e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):e},filterBlank:function(e){if(e==undefined)return[];"string"==typeof e&&(e=e.split(" "));for(var t=[],o=0;o<e.length;o++)""!=e[o]&&t.push(e[o]);return t},searchInArray:function(e,t){if(e&&e.length&&0<e.length)for(var o=e.length;o--;)if(0==csUtils.removeAccents(e[o]).toLowerCase().lastIndexOf(t,0))return!0},hasClass:function(e,t){domClasses=csUtils.filterBlank(e.className);for(var o=0;o<domClasses.length;o++)if(domClasses[o]==t)return!0;return!1},addClass:function(e,t){if(!csUtils.hasClass(e,t)){var o=csUtils.filterBlank(e.className);o.push(t),e.className=o.join(" ")}},removeClass:function(e,t){var o,s=csUtils.filterBlank(e.className),n=[];o="object"==typeof t&&"function"==typeof t.test?function(e,t){return t.test(e)}:function(e,t){return e==t};for(var c=0;c<s.length;c++)o(s[c],t)||n.push(s[c]);e.className=n.join(" ")},addEvent:function(e,t,o,s){"undefined"!=typeof e.addEventListener?e.addEventListener(t,o,!!s):"undefined"!=typeof e.attachEvent?e.attachEvent("on"+t,o):e["on"+t]=o},removeEvent:function(e,t,o){"undefined"!=typeof e.removeEventListener?e.removeEventListener(t,o,!1):"undefined"!=typeof e.detachEvent?e.detachEvent("on"+t,o):e["on"+t]=null},preventDefault:function(e){null!=e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},fetchJSON:function(e,t){var o=new XMLHttpRequest;o.onload=function(){try{t(JSON.parse(o.responseText))}catch(e){t({}),cloudspongeUI.csLogger.error(e)}},o.open("GET",e,!0),o.send()},createCORSRequest:function(e,t){var o=new XMLHttpRequest;return"withCredentials"in o?o.open(e,t,!0):"undefined"!=typeof XDomainRequest?(o=new XDomainRequest).open(e,t):o=null,o},removeAccents:function(e){return e?e.replace(/[^\u0000-\u007E]/g,function(e){return t[e]||e}):""},escapeHtml:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(e).replace(/[&<>"'`=\/]/g,function(e){return t[e]})},applyContactMethods:function(e){var t,o={selectedEmail:function(){var e;if(null!==this.email&&"undefined"!=typeof this.email)for(e=0;e<this.email.length;e++)if(this.email[e].selected)return this.email[e].address;return this.primaryEmail&&this.primaryEmail()},primaryEmail:function(){return null!==this.email&&"undefined"!=typeof this.email&&null!==this.email[0]&&"undefined"!=typeof this.email[0]?this.email[0].address:""},fullName:function(){return(this.first_name||"")+" "+(this.last_name||"")},hasValidEmail:function(){if(this.email&&this.email.filter){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return 0<this.email.filter(function(e){if(t.test(e.address))return e}).length}}};for(t=0;t<e.length;t++)for(var s in o)s&&(e[t][s]=o[s]);return e},filterNullEmailContacts:function(e){return e.map(function(e){return e.email=e.email.filter(function(e){if(e.address)return e}),e})},copyObj:function(e){switch(function(e){return Object.prototype.toString.call(e).slice(8,-1)}(e)){case"Array":var t,o=new Array,s=e.length;for(t=0;t<s;t++)o[t]=csUtils.copyObj(e[t]);return o;case"Object":var n;o=new Object;for(n in e)o[n]=csUtils.copyObj(e[n]);return o;default:return e}}}}();cloudspongeUI.utils=csUtils;var csTemplate=function(){var s=/<TEMPLATE ([^>]+)>((?:(?!<TEMPLATE)[\s\S])+?)<\/TEMPLATE>/g,n={BOOKS_TAB:csWidgetTemplate.getAddressBooksTab,BOOKS_ENTRY:csWidgetTemplate.getBooksEntry,LOADING_TAB:csWidgetTemplate.getLoadingTab,
LOGIN_TAB:csWidgetTemplate.getLoginTab,IMPORT_TAB:csWidgetTemplate.getImportTab,CONTACTS_TAB:csWidgetTemplate.getContactsManagerTab,CONTACT_ITEM:csWidgetTemplate.getContact,CONTACT_EMAIL:csWidgetTemplate.getEmail,CONTACT_PHONE:csWidgetTemplate.getPhone,CONTACT_ADDRESS:csWidgetTemplate.getAddress,OPTION_EMAIL:csWidgetTemplate.getOptionEmail,OPTION_PHONE:csWidgetTemplate.getOptionPhone,OPTION_ADDRESS:csWidgetTemplate.getOptionAddress,CONTACT_DETAIL:csWidgetTemplate.getContactDetails,LETTER_ITEM:csWidgetTemplate.getLetter,COPYRIGHT:csWidgetTemplate.getCopyright,STORAGE_MESSAGE:csWidgetTemplate.getStorageMessage,MOBILE_MORE_BUTTON:csWidgetTemplate.getMoreButton};return{TEMPLATE:{BOOKS_TAB:"BOOKS_TAB",BOOKS_ENTRY:"BOOKS_ENTRY",LOADING_TAB:"LOADING_TAB",LOGIN_TAB:"LOGIN_TAB",IMPORT_TAB:"IMPORT_TAB",CONTACTS_TAB:"CONTACTS_TAB",CONTACT_ITEM:"CONTACT_ITEM",CONTACT_EMAIL:"CONTACT_EMAIL",CONTACT_PHONE:"CONTACT_PHONE",CONTACT_ADDRESS:"CONTACT_ADDRESS",LETTER_ITEM:"LETTER_ITEM",OPTION_EMAIL:"OPTION_EMAIL",OPTION_PHONE:"OPTION_PHONE",OPTION_ADDRESS:"OPTION_ADDRESS",CONTACT_DETAIL:"CONTACT_DETAIL",COPYRIGHT:"COPYRIGHT",STORAGE_MESSAGE:"STORAGE_MESSAGE",MOBILE_MORE_BUTTON:"MOBILE_MORE_BUTTON"},parse:function(){var e=csUtils.getById(cloudspongeUI.controller.options.templateId);return e&&csTemplate.parseTemplates(csUtils.getText(e)),csTemplate.compile()},parseTemplates:function(e){function t(e,t,o){return n[t]=o,"${"+t+"}"}for(var o="";(e=e.replace(s,t))!==o;)o=e},getTemplate:function(e){if(n.hasOwnProperty(e))return"function"==typeof n[e]?n[e]():n[e]},compile:function(){return csUtils.fillStr(csWidgetTemplate.getBase(),[csTemplate.compileBooksTab()+csTemplate.compileLoadingTab()+csTemplate.compileLoginTab()+csTemplate.compileImportTab()+csTemplate.compileContactsTab()])},compileBooksTab:function(){return csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.BOOKS_TAB),{title:CS_LOCALE.ADDRESS_BOOK})},compileLoadingTab:function(){return csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.LOADING_TAB),{title:CS_LOCALE.AUTHORIZATION,oauthFocus:CS_LOCALE.AUTHORIZATION_FOCUS})},compileLoginTab:function(){return csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.LOGIN_TAB),{title:CS_LOCALE.SIGN_IN,signInAccount:CS_LOCALE.SIGN_IN_ACCOUNT,username:CS_LOCALE.USERNAME,password:CS_LOCALE.PASSWORD,signIn:CS_LOCALE.SIGN_IN,privacyNotice:CS_LOCALE.PRIVACY_NOTICE,privacyDisclaimer:CS_LOCALE.PRIVACY_DISCLAIMER,choiceAnother:CS_LOCALE.CHOICE_ANOTHER,clickHere:CS_LOCALE.CLICK_HERE,icloud_two_steps_verif:CS_LOCALE.ICLOUD_TWO_STEPS_VERIF})},compileImportTab:function(){return csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.IMPORT_TAB),{title:CS_LOCALE.IMPORT_CONTACTS,exportCSV:CS_LOCALE.EXPORT_CSV,dragFiles:CS_LOCALE.DRAG_FILES,dropFiles:CS_LOCALE.DROP_FILES,choiceAnother:CS_LOCALE.CHOICE_ANOTHER,goBack:CS_LOCALE.CLICK_HERE})},compileContactsTab:function(){return csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.CONTACTS_TAB),{title:CS_LOCALE.SELECT_CONTACTS,search_contacts:CS_LOCALE.SEARCH_CONTACTS,search_selected:CS_LOCALE.SEARCH_SELECTED,select_all:CS_LOCALE.SELECT_ALL,deselect_all:CS_LOCALE.DESELECT_ALL,select_search:CS_LOCALE.SELECT_SEARCH,deselect_search:CS_LOCALE.DESELECT_SEARCH,review_booked:CS_LOCALE.REVIEW_SELECTED,back_to_list:CS_LOCALE.BACK_TO_LIST,dict_items:csWidgetTemplate.getDictionary(),no_search_results:CS_LOCALE.NO_SEARCH_RESULTS,no_selected_contacts:CS_LOCALE.NO_SELECTED_CONTACTS,get_contacts:CS_LOCALE.GET_CONTACTS,get_contacts_mobile:CS_LOCALE.GET_CONTACTS_MOBILE})},compileStorageMessage:function(e,t){return t=t&&t.toLocaleString()||"never",csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.STORAGE_MESSAGE),{storage_enabled_status:CS_LOCALE.STORAGE_ENABLED_STATUS,storage_disabled_status:CS_LOCALE.STORAGE_DISABLED_STATUS,logged_as:csUtils.fillStr(CS_LOCALE.STORAGE_LOGGED_AS,["<strong>"+e+"</strong>"]),last_update:csUtils.fillStr(CS_LOCALE.STORAGE_LAST_UPDATE,["<strong>"+t+"</strong>"]),update_now:CS_LOCALE.STORAGE_BT_UPDATE_NOW,disable_cache:CS_LOCALE.STORAGE_BT_DISABLE_CACHE,enable_cache:CS_LOCALE.STORAGE_BT_ENABLE_CACHE})}}}();cloudspongeUI.template=csTemplate;var csWebHooks={beforeDisplayContacts:function(e){var t=cloudspongeUI.controller.options.webhooks&&cloudspongeUI.controller.options.webhooks.beforeDisplayContacts;t&&csWebHooks.post(t,e)},afterSubmitContacts:function(e,t,o,s,n){csWebHooks.post(e,{contacts:t,source:o,owner:s,import_id:n+""})},post:function(e,t){xdg=new XMLHttpRequest,xdg.open("POST",e),xdg.send(JSON.stringify(t))}};cloudspongeUI.webhooks=csWebHooks;var csModel=function(){function t(e){"function"==typeof e&&(e=e.call());var t=Math.floor(e);return t<0||!t?Infinity:t}function o(e){for(var t=0,o=e.length;t<o;t++){var s=e[t].email;if(s&&s.length){if(e[t].__selectedMail__=s[0].address,!f.IGNORE_MULTIPLE_MAILS)for(var n=0,c=s.length;n<c;n++)if(s[n].primary){e[t].__selectedMail__=s[n].address;break}}else e[t].__selectedMail__="";e[t].selectedEmail=function(){return this.__selectedMail__}}}function s(e){for(var t=0,o=e.length;t<o;t++){var s=e[t].phone;s&&s.length?e[t].__selectedPhone__=s[0].number:e[t].__selectedPhone__="",e[t].selectedPhone=function(){return this.__selectedPhone__}}}function n(e){for(var t=0,o=e.length;t<o;t++){var s=e[t];s.formatted=s.formatted||s.street+" "+s.city+" "+s.region+" "+s.postal_code}}function c(e){for(var t=0,o=e.length;t<o;t++){var s=e[t].address;n(s),s&&s.length?e[t].__selectedAddress__=s[0].formatted:e[t].__selectedAddress__="",e[t].selectedAddress=function(){return this.__selectedAddress__}}}function l(e){return"first"===f.SORTBY?(e.first_name||"")+(e.last_name||"")+(e.__selectedMail__||""):(e.last_name||"")+(e.first_name||"")+(e.__selectedMail__||"")}function i(e){for(var t=0,o=e.length;t<o;t++){var s=e[t],n=""==l(s)?"u":l(s)[0].toLowerCase();e[t].__letter__=n<"a"?"}":n}}function h(e,t){for(var o=e.email||[],s=t.length;s--;){var n=csUtils.removeAccents(t[s]);if(e.first_name&&0==csUtils.removeAccents(e.first_name).toLowerCase().lastIndexOf(n,0))return!0;if(e.last_name&&0==csUtils.removeAccents(e.last_name).toLowerCase().lastIndexOf(n,0))return!0;if(f.IGNORE_MULTIPLE_MAILS){if(o[0]&&(0==o[0].address.lastIndexOf(n,0)||-1<o[0].address.indexOf("@"+n)))return!0}else for(var c=o.length;c--;)if(0==o[c].address.lastIndexOf(n,0)||-1<o[c].address.indexOf("@"+n))return!0;if(csUtils.searchInArray(e.groups,n))return!0}return!1}function a(e){return e.sourceProperties=S[p],e.sourceProperties.groups&&cloudspongeUI.controller.options.onlyGroupedContacts&&(e=e.filter(function(e){return e.groups.length})),e.filter(f.FILTER)}function e(e){return!(!e.email||!e.email.length)}function r(e,t){return e.__letter__.charCodeAt()!=t.__letter__.charCodeAt()?e.__letter__.charCodeAt()-t.__letter__.charCodeAt():l(e).localeCompare(l(t))}function d(){csUtils.trackEvent("onSelectionLimitReached"),"function"==typeof cloudspongeUI.controller.options.onSelectionLimitReached?csUtils.triggerCallback("onSelectionLimitReached",u,f.LIMIT_MESSAGE):alert(f.LIMIT_MESSAGE)}var m,u,p,g,C=null,E=null,_=[],f={},T={OAUTH:1,CSV:2,CREDENTIALS:3},S={gmail:{name:"Gmail",auth:T.OAUTH,groups:!0},yahoo:{name:"Yahoo",auth:T.OAUTH,groups:!1},windowslive:{name:"Outlook.com",auth:T.OAUTH,groups:!1},aol:{name:"AOL",auth:T.OAUTH,groups:!1},office365:{name:"Office 365",auth:T.OAUTH,groups:!1},facebook:{name:"Facebook",auth:T.OAUTH},icloud:{name:"iCloud",auth:T.CREDENTIALS,groups:!1},uol:{name:"UOL",auth:T.CREDENTIALS,groups:!1},bol:{name:"BOL",auth:T.CREDENTIALS,groups:!1},terra:{name:"Terra",auth:T.CREDENTIALS,groups:!1},rediff:{name:"Rediff",auth:T.CREDENTIALS,groups:!1},mail126:{name:"126.com",auth:T.CREDENTIALS,groups:!1},mail163:{name:"163.com",auth:T.CREDENTIALS,groups:!1},mail_yeah_net:{name:"Yeah.net",auth:T.CREDENTIALS,groups:!1},mail_ru:{name:"Mail.ru",auth:T.CREDENTIALS,groups:!1},gmx:{name:"GMX",auth:T.CREDENTIALS,groups:!1},web_de:{name:"Web.de",auth:T.CREDENTIALS,groups:!1},qip_ru:{name:"QIP.ru",auth:T.CREDENTIALS,groups:!1},sapo:{name:"SAPO",auth:T.CREDENTIALS,groups:!1},mailcom:{name:"Mail.com",auth:T.CREDENTIALS,groups:!1},yandex_ru:{name:"Yandex",auth:T.CREDENTIALS,groups:!1},poczta_o2:{name:"O2.pl",auth:T.CREDENTIALS,groups:!1},naver:{name:"Naver",auth:T.CREDENTIALS,groups:!1},csv:{name:"Generic CSV",auth:T.CSV,groups:!1,url:""},linkedin:{name:"LinkedIn",auth:T.CSV,groups:!1,url:"https://www.cloudsponge.com/developer/linkedin_instructions/"},outlook:{name:"Outlook",auth:T.CSV,groups:!1,url:"https://support.office.com/en-us/article/export-contacts-from-outlook-10f09abd-643c-4495-bb80-543714eca73f"},addressbook:{name:"Mac Contacts",auth:T.CSV,groups:!1,url:"https://support.apple.com/en-ca/guide/contacts/adrbdcfd32e6/mac"},qq_mail:{name:"QQ mail",auth:T.CSV,groups:!1,url:"http://kf.qq.com/faq/120511z22Uzq130902E7ji6v.html"}},O=["gmail","yahoo","windowslive","aol","icloud","office365","outlook","addressbook","csv","mail_ru","uol","bol","terra","rediff","mail126","mail163","mail_yeah_net","gmx","web_de","qip_ru","sapo","mailcom","yandex_ru","qq_mail","poczta_o2","naver"];return{AUTH_TYPE:T,OPTIONS:f,initOptions:function(){csModel.OPTIONS=f={SELECT_ALL_NONE:null==cloudspongeUI.controller.options.displaySelectAllNone||cloudspongeUI.controller.options.displaySelectAllNone,INITIALLY_SELECTED:cloudspongeUI.controller.options.initiallySelectedContacts,SELECTION_LIMIT:t(cloudspongeUI.controller.options.selectionLimit),LIMIT_MESSAGE:cloudspongeUI.controller.options.selectionLimitMessage||CS_LOCALE.SELECTION_LIMIT,IGNORE_MULTIPLE_MAILS:cloudspongeUI.controller.options.ignoreMultipleEmails,GROUPED_CONTACTS:cloudspongeUI.controller.options.onlyGroupedContacts,INCLUDE:cloudspongeUI.controller.options.include||[],TEXTAREA_ID:cloudspongeUI.controller.options.textarea_id,TEXTAREA_SELECTOR:cloudspongeUI.controller.options.textareaSelector||".cloudsponge-contacts,.cs-contacts",LINKS_SELECTOR:cloudspongeUI.controller.options.linksSelector||".cloudsponge-launch,.cs-launch,.cs_import",REPLACE_CONTENT:cloudspongeUI.controller.options.replaceContent,CONTACTS_TEMPLATE:cloudspongeUI.controller.options.contactsTemplate,CONTACTS_DELIMITER:cloudspongeUI.controller.options.contactsDelimiter,WEBHOOKS:cloudspongeUI.controller.options.webhooks||{},FILTER:cloudspongeUI.controller.options.filter||e,COMPARE:!1!==cloudspongeUI.controller.options.compare&&(cloudspongeUI.controller.options.compare||r),SORTBY:cloudspongeUI.controller.options.sortBy||"last"}},setContacts:function(e){m=Object.create(null),u=0,csContactsView.closeContactsSearch(),o(_=a(e)),s(_),c(_),i(_),f.COMPARE&&_.sort(f.COMPARE),f.INITIALLY_SELECTED&&csModel.selectAll("")},getContacts:function(e){for(var t=[],o=e||{},s=o.onlySelected,n=(csUtils.removeAccents(o.searchStr)||"").trim(),c=n&&n.toLowerCase().split(/\W+/),l=0,i=_.length;l<i;l++){var a=_[l],r=csUtils.escapeHtml(a.first_name+" "+a.last_name),d=" "==r,u=(a.groups,f.IGNORE_MULTIPLE_MAILS?[a.email[0]]:a.email),p=a.phone&&0<a.phone.length?a.phone[0].number:"",g=a.phone,C=a.address,E=C&&0<C.length?C[0].formatted:"",T=(u&&u[0]&&u[0].address)!=undefined&&""!=u[0].address.trim();d&&T?r=csUtils.escapeHtml(u[0].address):d&&(r="Unknown"),s&&!m[l]||(n&&!h(_[l],c)||t.push({idx:l,name:r,email:u,job:a.job_title,company:a.companies&&a.companies[0],selected:m[l],isUnknown:d,selectedMail:a.__selectedMail__,letter:a.__letter__,suggested:a.__suggested__,phone:p,phones:g,address:E,addresses:C}))}return t},getContactsLength:function(){return _.length},getSelectedLength:function(){return u},isSelected:function(e){return m[e]},formatSelected:function(e,t){var o=csModel.loadContactsTemplate(e);return t&&t.trim&&(t=t.trim()).length&&o.unshift(t),"undefined"==typeof f.CONTACTS_DELIMITER&&(f.CONTACTS_DELIMITER=", "),o.join(f.CONTACTS_DELIMITER)},loadContactsTemplate:function(e){var t,o=[];if("string"==typeof f.CONTACTS_TEMPLATE){var s={name:csContactsTemplate.getName,email:csContactsTemplate.getEmail,"name+email":csContactsTemplate.getNameEmail,"name+phone":csContactsTemplate.getNamePhone,"name+email+phone":csContactsTemplate.getNameEmailPhone,"name+email+address":csContactsTemplate.getNameEmailAddress};t=s.hasOwnProperty(f.CONTACTS_TEMPLATE)?s[f.CONTACTS_TEMPLATE]():f.CONTACTS_TEMPLATE}else t=-1<f.INCLUDE.indexOf("name")?csContactsTemplate.getNameEmail():csContactsTemplate.getEmail();for(var n=0,c=e.length;n<c;n++)o.push(csUtils.fillStr(t,csModel.formattedContactHash(e[n])));return o},formattedContactHash:function(e){return{name:e.fullName().trim(),email:e.selectedEmail(),primaryEmail:e.primaryEmail(),firstName:e.first_name,lastName:e.last_name,jobTitle:e.job_title,company:e.companies[0]||"",companies:e.companies.join(" "),groups:e.groups.join(" "),dob:e.dob||"",birthday:e.birthday||"",phone:e.selectedPhone(),emailsList:e.email.map(function(e){return e.address}).join(" "),phonesList:e.phone.map(function(e){return e.number}).join(" "),homeAddress:e.address.map(function(e){if("home"==e.type)return[e.street,e.city,e.region,e.postal_code,e.country]}).join(" ").trim(),workAddress:e.address.map(function(e){if("work"==e.type)return[e.street,e.city,e.region,e.postal_code,e.country]}).join(" ").trim(),otherAddress:e.address.map(function(e){if("other"==e.type)return[e.street,e.city,e.region,e.postal_code,e.country]}).join(" ").trim(),address:e.address.map(function(e){if("home"==e.type)return[e.street,e.city,e.region,e.postal_code,e.country]}).join(" ").trim()}},appendToTextArea:function(e){var t=csUtils.getById(f.TEXTAREA_ID);t&&(t.value=csModel.formatSelected(e,t.value));var o=document.querySelectorAll(f.TEXTAREA_SELECTOR);if(o)for(var s=0,n=o.length;s<n;s++)o[s].value=csModel.formatSelected(e,o[s].value)},appendToWebHook:function(e){var t=f.WEBHOOKS.afterSubmitContacts;t&&csWebHooks.afterSubmitContacts(t,e,p,C,E+"")},exportSelected:function(){for(var e,t,o,s,n=[],c=0,l=_.length;c<l;c++)if(m[c]){for(e=_[c],n.push(e),s=0;s<e.email.length;s++)(t=e.email[s]).address===e.__selectedMail__?t.selected=!0:t.selected&&delete t.selected;for(s=0;s<e.phone.length;s++)(o=e.phone[s]).number===e.__selectedPhone__?o.selected=!0:o.selected&&delete o.selected}csModel.appendToTextArea(n),csUtils.triggerCallback("afterSubmitContacts",n,p,C),csUtils.trackEvent("onContactsSubmitted",{eventLabel:"Contacts Submitted",eventValue:n.length}),csUtils.trackPage("/submitted","Submitted Contacts"),csModel.appendToWebHook(n),cloudspongeUI.controller.end()},hasMultiMais:function(e){var t=_[e];return t.email&&1<t.email.length},selectContact:function(e){return!!m[e]||(u<t(cloudspongeUI.controller.options.selectionLimit)?(m[e]=!0,u++,!0):(d(),!1))},selectAll:function(e){for(var t=csModel.getContacts({searchStr:e}),o=0,s=t.length;o<s;o++)if(!csModel.selectContact(t[o].idx))return!1;return!0},unselectContact:function(e){m[e]=!1,u--},unselectAll:function(e){if(""!==e)for(var t=csModel.getContacts({onlySelected:!0,searchStr:e}),o=0,s=t.length;o<s;o++)csModel.unselectContact(t[o].idx);else u=0,m={}},updateContact:function(e,t){_[e].__selectedMail__=t},updateContactPhone:function(e,t){_[e].__selectedPhone__=t},updateContactAddress:function(e,t){_[e].__selectedAddress__=t},getContact:function(e){return _[e]},setProvider:function(e){p!==e&&(g=p,p=e,csWidget.setSource(e))},getProvider:function(){return p},getOldProvider:function(){return g},getOwner:function(){return C},getOwnerEmail:function(){if(C)return C.email&&C.email[0]&&C.email[0].address},setOwner:function(e){C=e},setImportId:function(e){E=e},getImportId:function(){return E},hasSource:function(e){return{}.hasOwnProperty.call(S,e)},getSource:function(e){var t={};return csModel.hasSource(e)&&(t=S[e],CS_LOCALE.PROVIDERS&&CS_LOCALE.PROVIDERS[e]&&(t.name=CS_LOCALE.PROVIDERS[e])),t},getAllSources:function(){return O.slice()}}}();cloudspongeUI.model=csModel;var csStorage=function(){function e(e){for(var t=0,o=e.length;t<o;t++)s?e[t].__proto__=n:csUtils.mixin(e[t],n)}function i(){if(csStorage.isEnabled())try{o(t,JSON.stringify(a))}catch(e){"QuotaExceededError"==e.name&&csStorage.disable()}}var a={},t="cloudsponge-data-cache-1",s=!("hasOwnProperty"in{__proto__:null}),n={fullName:function(){return(this.first_name||"")+" "+(this.last_name||"")},primaryEmail:function(){return null!==this.email&&"undefined"!=typeof this.email&&null!==this.email[0]&&"undefined"!=typeof this.email[0]?this.email[0].address:""},selectedEmail:function(){if(null!==this.email&&"undefined"!=typeof this.email){for(var e=0;e<this.email.length;e++)if(this.email[e].selected)return this.email[e].address;return this.primaryEmail&&this.primaryEmail()}}},o=function(){return!1};try{window.localStorage&&"object"==typeof window.localStorage&&window.localStorage.setItem&&window.localStorage.removeItem&&window.localStorage.getItem&&(o=function(e,t){try{return t?window.localStorage.setItem(e,t):null===t?window.localStorage.removeItem(e):window.localStorage.getItem(e)}catch(o){if(!/^NS_ERROR_/.test(o.name))throw o;try{window.localStorage.clear()}catch(o){}return!1}})}catch(l){}if(o(t))for(var c in a=JSON.parse(o(t)))({}).hasOwnProperty.call(a,c)&&e(a[c].contacts);return{localStorage:o,addSource:function(e,t,o,s){var n=60*cloudspongeUI.controller.options.browserContactCacheMin*1e3,c=Date.now(),l=c+n;a[e]={importId:s,source:e,owner:t,createdAt:c,expiredAt:l,contacts:o},i()},getSource:function(e){return a[e]&&a[e].expiredAt<=Date.now()&&(csStorage.removeSource(e),i()),a[e]?a[e]:null},removeSource:function(e){delete a[e]},value:function(){return a},destroy:function(){a={},o(t,null)},lastUpdate:function(e){return a[e]&&a[e].createdAt&&new Date(a[e].createdAt)},disable:function(){csStorage.destroy(),csPreferences.get().cacheDisabled=!0,csPreferences.save()},enable:function(){delete csPreferences.get().cacheDisabled,csPreferences.save(),i()},isEnabled:function(){return 0<cloudspongeUI.controller.options.browserContactCacheMin&&!csPreferences.get("cacheDisabled")},canBeEnabled:function(){return 0<cloudspongeUI.controller.options.browserContactCacheMin}}}();cloudspongeUI.storage=csStorage;var csPreferences=function(){var t={},o="cloudsponge-prefs",e=cloudspongeUI.storage.localStorage(o);return e&&(t=JSON.parse(e)),{save:function(){try{cloudspongeUI.storage.localStorage(o,JSON.stringify(t))}catch(e){}},get:function(e){return e?t[e]:t}}}();cloudspongeUI.preferences=csPreferences;var csLoadingView=function(){var c={TEXT:"cloudsponge-loader-text",LOADER:"cloudsponge-loading-gif",TRY_AGAIN:"cloudsponge-error-tryagain",OAUTH_FOCUS:"cloudsponge-oauth-focus",OAUTH_SPAN:"cloudsponge-oauth-focus-span"};return{setAuthorization:function(){csUtils.getById(c.TEXT).innerHTML=CS_LOCALE.AUTHORIZATION+"...",csUtils.showElement(c.LOADER)},loadSource:function(e){var t=csModel.getSource(e.toLowerCase());csUtils.getById(c.TEXT).innerHTML=csUtils.fillStr(CS_LOCALE.LOADING_CONTACTS,{provider:e,name:t.name}),csUtils.showElement(c.LOADER),1==csModel.getSource(e).auth?csUtils.addEvent(csUtils.getById(c.OAUTH_FOCUS),"click",function(){cloudspongeUI.controller.focus()}):csUtils.hideElement(c.OAUTH_SPAN)},failSource:function(e,t){var o=csModel.getSource(e.toLowerCase())||{},s=CS_LOCALE.UNABLE_LOAD_CONTACTS,n=t&&CS_LOCALE["ERROR_"+t];csUtils.getById(c.TEXT).innerHTML=csUtils.fillStr(s,{name:o.name||e,error_message:n||""}),csUtils.addEvent(csUtils.getById(c.TRY_AGAIN),"click",function(){cloudspongeUI.controller.launch(e)}),csUtils.hideElement(c.LOADER),csUtils.hideElement(c.OAUTH_SPAN)}}}(),csBooksView=function(){var l={BOOKS_LIST:"cloudsponge-providers-list"},i={TWO_BOOKS:"cloudsponge-two-books"};return{init:function(e){csBooksView.renderSources(csBooksView.getSources(e)),csUtils.addEvent(csUtils.getById(l.BOOKS_LIST),"click",csBooksView.onBookClick)},getSources:function(e){var t=[];if(e)for(var o=0,s=e.length;o<s;o++)csModel.hasSource(e[o])&&t.push(e[o]);return 0==t.length?csModel.getAllSources():t},renderSources:function(e){for(var t=[],o=2==e.length?i.TWO_BOOKS:"",s=0,n=e.length;s<n;s++){var c=csModel.getSource(e[s]);t.push(csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.BOOKS_ENTRY),{launcher:e[s],className:e[s],addClass:o,name:c.name}))}csUtils.getById(l.BOOKS_LIST).innerHTML=t.join("")},onBookClick:csUtils.delegate(function o(e){var t=e.getAttribute("data-launcher");return void 0!==t&&!!t},function t(e){cloudspongeUI.controller.launch(this.getAttribute("data-launcher")),csUtils.preventDefault(e)})}}(),csLoginView=function(){var s={ICON:"cloudsponge-source-icon",NAME:"cloudsponge-source-name",LOGIN_FORM:"cloudsponge-login-form",ERROR_MSG:"cloudsponge-login-error",USERNAME:"cloudsponge-login-user",PASSWORD:"cloudsponge-login-password",BACK:"cloudsponge-login-back",ICLOUD_TWO_STEPS_VERIF:"cloudsponge-icloud-two-steps-verification-message"},n={ICON:"cloudsponge-icon",ERROR:"cloudsponge-error"};return{init:function(){csUtils.addEvent(csUtils.getById(s.LOGIN_FORM),"submit",csLoginView.onSubmit),cloudspongeUI.controller.options.skipSourceMenu&&(csUtils.getById(s.BACK).style.display="none")},setOptions:function(e){csUtils.getById(s.USERNAME).value="",csUtils.getById(s.PASSWORD).value="",csUtils.getById(s.ICON).className=n.ICON+" "+csModel.getProvider(),csUtils.getById(s.NAME).innerHTML=e.name,"icloud"==csModel.getProvider()?csUtils.getById(s.ICLOUD_TWO_STEPS_VERIF).style.display="block":csUtils.getById(s.ICLOUD_TWO_STEPS_VERIF).style.display="none"},isValidForm:function(){var e=csUtils.getById(s.USERNAME),t=csUtils.getById(s.PASSWORD),o=csUtils.getById(s.ERROR_MSG);return e.value.trim()?(csUtils.removeClass(e,n.ERROR),t.value.trim()?(csUtils.removeClass(t,n.ERROR),o.style.display="none",!0):(o.innerHTML=CS_LOCALE.ENTER_PASSWORD,o.style.display="block",csUtils.addClass(t,n.ERROR),!1)):(o.innerHTML=CS_LOCALE.ENTER_USERNAME,o.style.display="block",csUtils.addClass(e,n.ERROR),!1)},onSubmit:function(e){csLoginView.isValidForm()&&cloudspongeUI.controller.login({importId:csModel.getImportId(),source:csModel.getProvider(),authorizationType:"credentials",currentEvent:{eventType:"initializing",status:"inprogress"},requiredFields:["username","password"],username:csUtils.getById(s.USERNAME).value,password:csUtils.getById(s.PASSWORD).value}),csUtils.preventDefault(e)}}}(),csImportView=function(){var c={ICON:"cloudsponge-csv-icon",LINK:"cloudsponge-csv-export",BUTTON:"cloudsponge-csv-contacts",NOT_SUPPORTED:"cloudsponge-csv-not-supported",FILE_FIELD:"cloudsponge-file-upload",FILE_INPUT:"cloudsponge-file-upload-input",UPLOAD_FORM:"cloudsponge-import-form",BACK:"cloudsponge-import-back",GENERIC_CSV_UI:"cloudsponge-csv-generic",SPECIFIC_CSV_UI:"cloudsponge-csv-specific"},l={ICON:"cloudsponge-icon"};return{init:function(){csUtils.getById(c.FILE_INPUT).value="",csUtils.addEvent(csUtils.getById(c.FILE_FIELD),"click",csImportView.onClick),csUtils.addEvent(csUtils.getById(c.FILE_INPUT),"change",csImportView.onChange),cloudspongeUI.controller.options.skipSourceMenu&&(csUtils.getById(c.BACK).style.display="none")},setOptions:function(e){csUtils.getById(c.ICON).className=l.ICON+" "+csModel.getProvider(),csUtils.getById(c.LINK).href=e.url,csUtils.getById(c.BUTTON).innerHTML=csUtils.fillStr(CS_LOCALE.GET_CSV_CONTACTS,{name:e.name}),csUtils.getById(c.NOT_SUPPORTED).innerHTML=csUtils.fillStr(CS_LOCALE.NOT_SUPPORTED,{name:e.name});var t,o,s=c.GENERIC_CSV_UI,n=c.SPECIFIC_CSV_UI;for("csv"==csModel.getProvider()&&(s=c.SPECIFIC_CSV_UI,n=c.GENERIC_CSV_UI),t=csUtils.getByClassName(n),o=0;o<t.length;o++)csUtils.showElement(t[o]);for(t=csUtils.getByClassName(s),o=0;o<t.length;o++)csUtils.hideElement(t[o])},onClick:function(){csUtils.getById(c.FILE_INPUT).click()},onChange:function(){cloudspongeUI.controller.upload({source:csModel.getProvider(),file:csUtils.getById(c.FILE_INPUT).files[0]})}}}(),csContactsView=function(){function c(e){t[e]=1}function l(e){return!!t[e]&&!(t[e]=0)}function i(e){return!!t[e]}var E=50,b={SEARCH_BAR:"cloudsponge-search-bar",PROVIDER_ICON:"cloudsponge-provider-icon",SEARCH_CONTACTS:"cloudsponge-search-contacts",SEARCH_BOOKED:"cloudsponge-search-booked",CONTACTS_TITLE:"cloudsponge-contacts-title",CONTACTS_SCROLL:"cloudsponge-contacts-scrolling-region",CONTACTS_LIST:"cloudsponge-contacts-list",EXPORT_BUTTON:"cloudsponge-export-button",GET_CONTACTS:"cloudsponge-get-contacts",GET_CONTACTS_MOBILE:"cloudsponge-get-contacts-mobile",SELECT_ALL_BUTTON:"cloudsponge-select-all",DESELECT_ALL_BUTTON:"cloudsponge-deselect-all",CLOSE_CONTACTS_SEARCH:"cloudsponge-contacts-search-close",CLOSE_BOOKED_SEARCH:"cloudsponge-booked-search-close",SELECT_SEARCH_BUTTON:"cloudsponge-select-search",DESELECT_SEARCH_BUTTON:"cloudsponge-deselect-search",BOOKED_SWITCH:"cloudsponge-review-booked",CONTACTS_SWITCH:"cloudsponge-back-to-list",DICTIONARY:"cloudsponge-dictionary",LETTER_PREVIEW:"cloudsponge-letter-preview",DETAILS_TAB:"cloudsponge-details-tab",CONTACTS_TAB:"cloudsponge-contacts-tab"},s={NO_SEARCH_RESULTS:"cloudsponge-no-search-results",NO_SELECTED_CONTACTS:"cloudsponge-no-selected-contacts"},N={DISABLED:"cloudsponge-disabled",SELECTED:"cloudsponge-selected",CHECKED:"cloudsponge-checked",DEFAULT:"cloudsponge-default",HIDDEN:"cloudsponge-hidden",DELETE:"cross",CHECKBOX:"cloudsponge-checkbox",OPENED:"cloudsponge-opened",NO_NAME:"cloudsponge-no-name",DISABLE_LETTERS:"cloudsponge-disable-letter",ALPHABET_VISIBLE:"cloudsponge-alphabet-visible",MULTIPLE_MAILS:"cloudsponge-multiple-mails",MULTIPLE_PHONES:"cloudsponge-multiple-phones",MULTIPLE_ADDRESSES:"cloudsponge-multiple-addresses",MAIL_LABEL:"cloudsponge-mail-label",PHONE_LABEL:"cloudsponge-phone-label",ADDRESS_LABEL:"cloudsponge-address-label"},t={HAS_SELECTED:0,ALL_SELECTED:0,SEARCH_CONTACTS:0,HAS_CONTACTS:0,SEARCH_BOOKED:0,HAS_BOOKED:0,CONTACTS_PANEL:0,REVIEW_PANEL:0,GRANT_SCROLL:0};return{init:function(){csContactsView.__dropdown__=null,csContactsView.initEvents()},show:function(){var e=csModel.getProvider(),t=csModel.getOldProvider();csContactsView.setProvider(e,t),csContactsView.setContactsPlaceholders(csModel.getContactsLength(),e),csContactsView.showContacts()},initEvents:function(){csUtils.addEvent(csUtils.getById(b.CONTACTS_SCROLL),"click",csContactsView.onSelectMail),csUtils.addEvent(csUtils.getById(b.CONTACTS_LIST),"click",csContactsView.onSelectPhone),csUtils.addEvent(csUtils.getById(b.CONTACTS_LIST),"click",csContactsView.onSelectAddress),csUtils.addEvent(csUtils.getById(b.CONTACTS_LIST),"click",csContactsView.onClickMore),csUtils.addEvent(csUtils.getById(b.CONTACTS_SCROLL),"click",csContactsView.onDropDownOpen),csUtils.addEvent(csUtils.getById(b.CONTACTS_SCROLL),"click",csContactsView.onDropDownClose),csUtils.addEvent(csUtils.getById(b.CONTACTS_SCROLL),"click",csContactsView.onRowClick),csUtils.addEvent(csUtils.getById(b.CONTACTS_SCROLL),"mousedown",csContactsView.onSelectClick),csUtils.addEvent(csUtils.getById(b.CONTACTS_SCROLL),"click",csContactsView.onSelectClick),csUtils.addEvent(csUtils.getById(b.CONTACTS_SCROLL),"change",csContactsView.onChangeSelect),csUtils.addEvent(csUtils.getById(b.SEARCH_CONTACTS),"input",csContactsView.onSearchContacts),csUtils.addEvent(csUtils.getById(b.SEARCH_CONTACTS),"focus",csContactsView.hideDictionary),csUtils.addEvent(csUtils.getById(b.SEARCH_CONTACTS),"blur",csContactsView.showDictionary),csUtils.addEvent(csUtils.getById(b.CLOSE_CONTACTS_SEARCH),"click",csContactsView.onCloseSearchContacts),csUtils.addEvent(csUtils.getById(b.SEARCH_BOOKED),"input",csContactsView.onSearchBooked),csUtils.addEvent(csUtils.getById(b.CLOSE_BOOKED_SEARCH),"click",csContactsView.onCloseSearchBooked),csUtils.addEvent(csUtils.getById(b.SELECT_ALL_BUTTON),"click",csContactsView.onBookAllContacts),csUtils.addEvent(csUtils.getById(b.SELECT_SEARCH_BUTTON),"click",csContactsView.onBookAllContacts),csUtils.addEvent(csUtils.getById(b.DESELECT_ALL_BUTTON),"click",csContactsView.onUnBookAllContacts),csUtils.addEvent(csUtils.getById(b.DESELECT_SEARCH_BUTTON),"click",csContactsView.onUnBookAllContacts),csUtils.addEvent(csUtils.getById(b.BOOKED_SWITCH),"click",csContactsView.onShowBooked),csUtils.addEvent(csUtils.getById(b.CONTACTS_SWITCH),"click",csContactsView.onShowContacts),csUtils.addEvent(csUtils.getById(b.CONTACTS_SCROLL),"scroll",csContactsView.onContactsScroll()),csUtils.addEvent(csUtils.getById(b.DICTIONARY),"click",csContactsView.onDictClick),csUtils.addEvent(csUtils.getById(b.EXPORT_BUTTON),"click",csContactsView.onExportContacts)},showContacts:function(){csContactsView.hideBooked(),csContactsView.resetSearchBar(),csContactsView.searchContacts(),c("CONTACTS_PANEL"),csContactsView.updateCounters()},hideContacts:function(){l("CONTACTS_PANEL")},showBooked:function(){csContactsView.hideContacts(),csContactsView.resetSearchBar(),csContactsView.searchBooked(),c("REVIEW_PANEL"),csContactsView.updateCounters()},hideBooked:function(){l("REVIEW_PANEL")},searchContacts:function(){var e=csUtils.getById(b.SEARCH_CONTACTS),t=csModel.getContacts({searchStr:e.value});csUtils.hideElement(s.NO_SEARCH_RESULTS),csUtils.hideElement(s.NO_SELECTED_CONTACTS),0==t.length?(l("HAS_CONTACTS"),csUtils.hideElement(b.CONTACTS_LIST),csUtils.showElement(s.NO_SEARCH_RESULTS)):(c("HAS_CONTACTS"),csUtils.showElement(b.CONTACTS_LIST)),csContactsView.renderContacts(t),csContactsView.updateSearchCounters(t.length)},searchBooked:function(){var e=csUtils.getById(b.SEARCH_BOOKED),t=(csUtils.getById(b.DESELECT_ALL_BUTTON),e.value.trim()),o=csModel.getContacts({onlySelected:!0,searchStr:t});csUtils.hideElement(s.NO_SEARCH_RESULTS),csUtils.hideElement(s.NO_SELECTED_CONTACTS),0==o.length?(l("HAS_BOOKED"),t?csUtils.showElement(s.NO_SEARCH_RESULTS):csUtils.showElement(s.NO_SELECTED_CONTACTS),csUtils.hideElement(b.CONTACTS_LIST)):(c("HAS_BOOKED"),csUtils.showElement(b.CONTACTS_LIST),csContactsView.renderContacts(csModel.getContacts({onlySelected:!0,searchStr:e.value}))),csContactsView.updateSearchCounters(o.length)},initDictionary:function(){for(var e=csUtils.getById(b.DICTIONARY).getElementsByTagName("a"),t=e.length;t--;){csUtils.getById(e[t].getAttribute("data-for"))?csUtils.removeClass(e[t],N.DISABLED):csUtils.addClass(e[t],N.DISABLED)}},updateSearchCounters:function(e){var t=csUtils.getById(b.SELECT_SEARCH_BUTTON),o=csUtils.getById(b.DESELECT_SEARCH_BUTTON);t.innerHTML=csUtils.fillStr(CS_LOCALE.SELECT_SEARCH,[e]),o.innerHTML=csUtils.fillStr(CS_LOCALE.DESELECT_SEARCH,[e]),csContactsView.updateUI()},updateCounters:function(){var e=csModel.getSelectedLength(),t=csModel.getContactsLength();csContactsView.setBookedPlaceholders(e),0<e?c("HAS_SELECTED"):l("HAS_SELECTED"),e==t?c("ALL_SELECTED"):l("ALL_SELECTED"),csContactsView.updateUI()},showDictionary:function(){csUtils.showElement(b.DICTIONARY)},hideDictionary:function(){csUtils.hideElement(b.DICTIONARY)},updateUI:function(){csUtils.hideElement(b.BOOKED_SWITCH),csUtils.hideElement(b.SELECT_ALL_BUTTON),csUtils.hideElement(b.DESELECT_ALL_BUTTON),csUtils.hideElement(b.SELECT_SEARCH_BUTTON),csUtils.hideElement(b.DESELECT_SEARCH_BUTTON),csUtils.hideElement(b.DICTIONARY),csUtils.hideElement(b.LETTER_PREVIEW),csContactsView.hideLetters(),csUtils.removeClass(csUtils.getById(b.CONTACTS_LIST),N.ALPHABET_VISIBLE),i("CONTACTS_PANEL")?(csUtils.showElement(b.SEARCH_CONTACTS),i("SEARCH_CONTACTS")||(csContactsView.initDictionary(),csContactsView.showLetters(),"SELECT"!==document.activeElement.tagName&&"cloudsponge-search-contacts"!==document.activeElement.id?csUtils.showElement(b.DICTIONARY):csUtils.addEvent(document.activeElement,"blur",csContactsView.showDictionary),csUtils.addClass(csUtils.getById(b.CONTACTS_LIST),N.ALPHABET_VISIBLE)),i("ALL_SELECTED")&&csModel.OPTIONS.SELECT_ALL_NONE?csUtils.showElement(b.DESELECT_ALL_BUTTON):csModel.OPTIONS.SELECT_ALL_NONE&&csUtils.showElement(b.SELECT_ALL_BUTTON)):csUtils.hideElement(b.SEARCH_CONTACTS),i("REVIEW_PANEL")?(csUtils.showElement(b.SEARCH_BOOKED),csUtils.showElement(b.CONTACTS_SWITCH),i("HAS_SELECTED")&&csModel.OPTIONS.SELECT_ALL_NONE?csUtils.showElement(b.DESELECT_ALL_BUTTON):csUtils.hideElement(b.DESELECT_ALL_BUTTON)):(csUtils.hideElement(b.SEARCH_BOOKED),csUtils.hideElement(b.CONTACTS_SWITCH)),i("SEARCH_CONTACTS")&&i("CONTACTS_PANEL")?(csUtils.showElement(b.CLOSE_CONTACTS_SEARCH),csUtils.showElement(b.SELECT_SEARCH_BUTTON),csUtils.hideElement(b.SELECT_ALL_BUTTON),csUtils.hideElement(b.DESELECT_ALL_BUTTON)):csUtils.hideElement(b.CLOSE_CONTACTS_SEARCH),i("SEARCH_BOOKED")&&i("REVIEW_PANEL")?(csUtils.showElement(b.CLOSE_BOOKED_SEARCH),csUtils.showElement(b.DESELECT_SEARCH_BUTTON),csUtils.hideElement(b.DESELECT_ALL_BUTTON)):csUtils.hideElement(b.CLOSE_BOOKED_SEARCH),i("HAS_SELECTED")?(i("CONTACTS_PANEL")&&csUtils.showElement(b.BOOKED_SWITCH),csContactsView.enableExportButton(),cloudspongeUI.controller.options.alwaysShowCTA||csContactsView.showExportButton()):(csContactsView.disableExportButton(),cloudspongeUI.controller.options.alwaysShowCTA||csContactsView.hideExportButton()),csUtils.getById("cloudsponge-storage-logged-user")&&(
csUtils.addEvent(csUtils.getById("cloudsponge-storage-update"),"click",csContactsView.updateStorage),csUtils.addEvent(csUtils.getById("cloudsponge-storage-disable"),"click",csContactsView.disableCache),csUtils.addEvent(csUtils.getById("cloudsponge-storage-enable"),"click",csContactsView.enableCache),csUtils.hideElement(csUtils.getById("cloudsponge-storage-status-disabled")),csUtils.hideElement(csUtils.getById("cloudsponge-storage-status-enabled")),csStorage.isEnabled()?csUtils.showElement(csUtils.getById("cloudsponge-storage-status-enabled")):csStorage.canBeEnabled()&&csUtils.showElement(csUtils.getById("cloudsponge-storage-status-disabled")),csModel.getOwnerEmail()||csUtils.hideElement(csUtils.getById("cloudsponge-storage-logged-user")))},enableCache:function(){csStorage.enable(),csContactsView.updateUI()},disableCache:function(){csStorage.disable(),csContactsView.updateUI()},updateStorage:function(){var e=csModel.getProvider();csStorage.removeSource(e),cloudspongeUI.controller.launch(e)},setZIndex:function(e){for(var t=csUtils.getBySel("#cloudsponge-address-book .cloudsponge-topbar"),o=t.length;o--;)t[o].style.zIndex=e;csUtils.getById(b.EXPORT_BUTTON).style.zIndex=e},setProvider:function(e){var t=csUtils.getById(b.PROVIDER_ICON),o=csUtils.getById(b.SEARCH_CONTACTS),s=t.getAttribute("data-base-class")||"",n=csModel.getSource(e).name||e;t.className=s+" "+e,o.placeholder=csUtils.fillStr(CS_LOCALE.SEARCH_CONTACTS,[n])},setContactsPlaceholders:function(e){csUtils.getById(b.SELECT_ALL_BUTTON).innerHTML=csUtils.fillStr(CS_LOCALE.SELECT_ALL,[e])},setBookedPlaceholders:function(e){var t=csUtils.getById(b.GET_CONTACTS),o=csUtils.getById(b.DESELECT_ALL_BUTTON),s=csUtils.getById(b.BOOKED_SWITCH);t.innerHTML=csUtils.fillStr(CS_LOCALE.GET_CONTACTS,[e]),o.innerHTML=csUtils.fillStr(CS_LOCALE.DESELECT_ALL,[e]),s.innerHTML=csUtils.fillStr(CS_LOCALE.REVIEW_SELECTED,[e])},showExportButton:function(){csUtils.showElement(b.EXPORT_BUTTON)},hideExportButton:function(){csUtils.hideElement(b.EXPORT_BUTTON)},disableExportButton:function(){csUtils.addClass(csUtils.getById(b.EXPORT_BUTTON),"disabled")},enableExportButton:function(){csUtils.removeClass(csUtils.getById(b.EXPORT_BUTTON),"disabled")},resetSearchBar:function(){var e=csUtils.getById(b.SEARCH_BAR);csUtils.getById(b.CONTACTS_LIST).scrollTop=0,e.style.top=e.style.marginBottom=0},hideSearchBar:function(){var e=csUtils.getById(b.SEARCH_BAR);e.style.top=e.style.marginBottom=-e.offsetHeight+"px"},hideLetters:function(){var e=csUtils.getById(b.CONTACTS_LIST);csUtils.addClass(e,N.DISABLE_LETTERS)},showLetters:function(){var e=csUtils.getById(b.CONTACTS_LIST);csUtils.removeClass(e,N.DISABLE_LETTERS)},hideDropDown:function(){csContactsView.__dropdown__&&(csUtils.removeClass(csContactsView.__dropdown__,N.OPENED),csContactsView.__dropdown__=null)},closeContactsSearch:function(){l("SEARCH_CONTACTS"),csUtils.getById(b.SEARCH_CONTACTS).value="",csContactsView.searchContacts()},closeBookedSearch:function(){l("SEARCH_BOOKED"),csUtils.getById(b.SEARCH_BOOKED).value="",csContactsView.searchBooked()},bookContact:function(e){var t=e.getAttribute("data-index");csModel.isSelected(t)||csModel.selectContact(t)&&(csUtils.getByTag(e,"input")[0].checked=!0,csUtils.addClass(e,N.SELECTED)),csContactsView.updateCounters()},bookAllContacts:function(){csModel.selectAll(csUtils.getById(b.SEARCH_CONTACTS).value.trim()),csContactsView.searchContacts(),csContactsView.updateCounters()},unbookContact:function(e){var t=i("REVIEW_PANEL"),o=csModel.getSelectedLength()-1,s=e.getAttribute("data-index");csUtils.removeClass(e,N.SELECTED),csUtils.getByTag(e,"input")[0].checked=!1,csModel.unselectContact(s),csContactsView.updateCounters(),t&&(0==o?csContactsView.searchBooked():csUtils.addClass(e,N.HIDDEN))},unbookAllContacts:function(){i("REVIEW_PANEL")?(csModel.unselectAll(csUtils.getById(b.SEARCH_BOOKED).value.trim()),csContactsView.closeBookedSearch()):(csModel.unselectAll(),csContactsView.searchContacts()),csContactsView.updateCounters()},renderContacts:function(e){for(var t="",o="",s=!1,n=0,c=e.length;n<c;n++){var l=e[n],i=l.name.trim(),a=l.selected,r=l.email,d="",u="",p=r.length,g=1<p,C="",E="",T="",h=l.phones,m=h.length,_=1<m,f="",S="",O=l.addresses,A=O&&O.length||0,I=1<A;if(l.suggested?s||(t+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.LETTER_ITEM),{letter:CS_LOCALE.SUGGESTIONS}),s=!0):l.letter!==o&&(o=l.letter,t+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.LETTER_ITEM),{letter:"}"==o?"#":o})),g)for(var L=0;L<p;L++){var v=l.selectedMail===r[L].address;d+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.CONTACT_EMAIL),{email:r[L].address,type:r[L].type,primary:r[L].primary,index:l.idx}),u+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.OPTION_EMAIL),{email:r[L].address,type:r[L].type,primary:r[L].primary,index:l.idx,selected:l.selectedMail===r[L].address?'selected="selected"':""})}if(_)for(L=0;L<m;L++){v=l.selectedPhone===h[L].number;E+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.CONTACT_PHONE),{phone:h[L].number,type:h[L].type,index:l.idx}),T+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.OPTION_PHONE),{phone:h[L].number,type:h[L].type,index:l.idx,selected:l.selectedPhone===h[L].number?'selected="selected"':""})}if(I)for(L=0;L<A;L++){v=l.selectedAddress===O[L].formatted;f+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.CONTACT_ADDRESS),{address:O[L].formatted,type:O[L].type,index:l.idx}),S+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.OPTION_ADDRESS),{address:O[L].formatted,type:O[L].type,index:l.idx,selected:v?'selected="selected"':""})}(g||_||I)&&(C=csTemplate.getTemplate(csTemplate.TEMPLATE.MOBILE_MORE_BUTTON));var U={index:l.idx,class_name:a?N.SELECTED:"",unknown_class:l.isUnknown?N.NO_NAME:"",checked:a?'checked="checked"':"",name:i,email:l.selectedMail,phone:l.phone,address:l.address,formatted_email:l.selectedMail,disabled:g?"":'style="display:none;"',multiple_class:g?N.MULTIPLE_MAILS:"",plus_contacts:g?csUtils.fillStr(CS_LOCALE.MORE_MAILS,[p-1]):"",phone_disabled:_?"":'style="display:none;"',plus_phone:_?csUtils.fillStr(CS_LOCALE.MORE_PHONES,[m-1]):"",multiple_phone_class:_?N.MULTIPLE_PHONES:"",address_disabled:I?"":'style="display:none;"',plus_addresses:I?csUtils.fillStr(CS_LOCALE.MORE_MAILS,[A-1]):"",multiple_address_class:I?N.MULTIPLE_ADDRESSES:"",more_button:C,CONTACT_PHONE:E,CONTACT_EMAIL:d,OPTION_EMAIL:u,OPTION_PHONE:T,CONTACT_ADDRESS:f,OPTION_ADDRESS:S};t+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.CONTACT_ITEM),U)}csUtils.getById(b.CONTACTS_LIST).innerHTML=t,t=csTemplate.compileStorageMessage(csModel.getOwnerEmail(),csStorage.lastUpdate(csModel.getProvider())),csUtils.setHTML(csUtils.getByClassName("cloudsponge-storage-message"),t),t=csTemplate.getTemplate(csTemplate.TEMPLATE.COPYRIGHT),csUtils.setHTML(csUtils.getByClassName("cloudsponge-copyright-item"),t)},onSearchContacts:function(){var e=csUtils.getById(b.SEARCH_CONTACTS);e.value;clearTimeout(csContactsView.onSearchContacts.__timer__),e.value.trim()?csContactsView.onSearchContacts.__timer__=setTimeout(function(){c("SEARCH_CONTACTS"),csContactsView.searchContacts()},200):i("SEARCH_CONTACTS")&&(l("SEARCH_CONTACTS"),e.value="",csContactsView.searchContacts())},onCloseSearchContacts:function(e){csContactsView.closeContactsSearch(),csUtils.preventDefault(e)},onSearchBooked:function(){var e=csUtils.getById(b.SEARCH_BOOKED);e.value;e.value.trim()?(c("SEARCH_BOOKED"),csContactsView.searchBooked()):i("SEARCH_BOOKED")&&(l("SEARCH_BOOKED"),e.value="",csContactsView.searchBooked())},onCloseSearchBooked:function(e){csContactsView.closeBookedSearch(),csUtils.preventDefault(e)},onRowClick:csUtils.delegate(function o(e){return"contact"===e.getAttribute("data-type")},function T(e){var t=this,o=t.getAttribute("data-mail"),s=t.getAttribute("data-index");csModel.isSelected(s,o)?csContactsView.unbookContact(this):csContactsView.bookContact(this),csUtils.preventDefault(e)}),onBookAllContacts:function(e){csContactsView.bookAllContacts(),csUtils.preventDefault(e)},onUnBookAllContacts:function(e){CS_LOCALE.DESELECT_CONFIRM&&!window.confirm(CS_LOCALE.DESELECT_CONFIRM)||csContactsView.unbookAllContacts(),csUtils.preventDefault(e)},onDropDownOpen:csUtils.delegate(function o(e){return csUtils.hasClass(e,N.MULTIPLE_MAILS)||csUtils.hasClass(e,N.MULTIPLE_PHONES)||csUtils.hasClass(e,N.MULTIPLE_ADDRESSES)},function T(e){var t=csUtils.getByTag(this,"ul")[0],o=(csUtils.getByTag(this,"select")[0],csContactsView.__dropdown__);csContactsView.hideDropDown(),o!==t&&(csUtils.addClass(t,N.OPENED),csContactsView.__dropdown__=t),e.stopImmediatePropagation(),csUtils.preventDefault(e)}),onDropDownClose:function(){csContactsView.hideDropDown()},onChangeSelect:csUtils.delegate(function o(e){return"SELECT"==e.tagName},function T(){var e=this.parentNode;label=csUtils.getByClassName(e,N.MAIL_LABEL)[0],id=e.getAttribute("data-index"),csModel.updateContact(id,this.value),label.innerHTML=csUtils.truncate(this.value,E),label.title=this.value,csContactsView.hideDropDown(),csContactsView.bookContact(e)}),onSelectClick:csUtils.delegate(function o(e){return"SELECT"==e.tagName},function T(e){var t=this.parentNode,o=t.getAttribute("data-index"),s=!1;csModel.isSelected(o)?(csContactsView.unbookContact(t),s=!0):csContactsView.bookContact(t),!s&&csModel.hasMultiMais(o)||csUtils.preventDefault(e)}),onSelectMail:csUtils.delegate(function o(e){return"option"==e.getAttribute("data-type")},function T(e){var t=this.getAttribute("data-index"),o=this.getAttribute("data-mail"),s=this.parentNode.parentNode.parentNode.parentNode;label=csUtils.getByClassName(s,N.MAIL_LABEL)[0],o&&(csModel.updateContact(t,o),label.innerHTML=csUtils.truncate(o,E),label.title=o,csContactsView.hideDropDown(),csContactsView.bookContact(s),e.stopImmediatePropagation()),csUtils.preventDefault(e)}),onSelectPhone:csUtils.delegate(function o(e){return"option"==e.getAttribute("data-type")},function T(e){var t=this.getAttribute("data-index"),o=this.getAttribute("data-phone"),s=this.parentNode.parentNode.parentNode.parentNode;label=csUtils.getByClassName(s,N.PHONE_LABEL)[0],o&&(csModel.updateContactPhone(t,o),label.innerHTML=o,label.title=o,csContactsView.hideDropDown(),csContactsView.bookContact(s),e.stopImmediatePropagation()),csUtils.preventDefault(e)}),onSelectAddress:csUtils.delegate(function o(e){return"option"==e.getAttribute("data-type")},function T(e){var t=this.getAttribute("data-index"),o=this.getAttribute("data-address"),s=this.parentNode.parentNode.parentNode.parentNode;label=csUtils.getByClassName(s,N.ADDRESS_LABEL)[0],o&&(csModel.updateContactAddress(t,o),label.innerHTML=o,label.title=o,csContactsView.hideDropDown(),csContactsView.bookContact(s),e.stopImmediatePropagation()),csUtils.preventDefault(e)}),onClickMore:csUtils.delegate(function o(e){return"more"==e.getAttribute("data-type")},function T(){var e=this.parentElement.getAttribute("data-index"),t=csModel.getContact(e),o=(t.selected,t.email),s=t.phone,n="",c="",l="";mailsLength=o.length,isMultiMails=1<mailsLength,phonesLength=s.length,isMultiPhones=1<phonesLength,addresses=t.address,addressLength=addresses&&addresses.length||0,isMultiAddresses=1<addressLength;for(var i=0;i<mailsLength;i++){var a=t.selectedEmail()===o[i].address;n+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.OPTION_EMAIL),{email:o[i].address,type:o[i].type,primary:o[i].primary,index:t.idx,selected:t.selectedEmail()===o[i].address?'selected="selected"':""})}for(i=0;i<phonesLength;i++){a=t.selectedPhone()===s[i].number;c+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.OPTION_PHONE),{phone:s[i].number,type:s[i].type,index:t.idx,selected:t.selectedPhone()===s[i].number?'selected="selected"':""})}for(i=0;i<addressLength;i++){a=t.__selectedAddress__===addresses[i].number;l+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.OPTION_ADDRESS),{address:addresses[i].formatted,type:addresses[i].type,index:t.idx,selected:a?'selected="selected"':""})}var r=csUtils.getById("cloudsponge-address-book");csUtils.hideElement(b.CONTACTS_TAB);var d=document.createElement("div"),u={title:CS_LOCALE.DETAILS_TITLE,email_label:CS_LOCALE.DETAILS_EMAIL,phone_label:CS_LOCALE.DETAILS_PHONE,address_label:CS_LOCALE.DETAILS_ADDRESS,id:e,name:t.fullName(),OPTION_EMAIL:n,OPTION_PHONE:c,OPTION_ADDRESS:l};d.innerHTML=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.CONTACT_DETAIL),u),d=d.firstChild,r.appendChild(d);for(var p=csUtils.getByClassName("cloudsponge-back-button"),g=p.length;g--;)csUtils.addEvent(p[g],"click",csWidget.onBack);var C=csUtils.getByClassName("cloudsponge-email-select")[0];C&&csUtils.addEvent(C,"change",function(){var t=this.getAttribute("data-index"),e=this.value,o=csUtils.getByClassName("cloudsponge-contact-item").filter(function(e){if(e.getAttribute("data-index")===t)return e})[0],s=csUtils.getByClassName(o,N.MAIL_LABEL)[0];csModel.updateContact(t,e),s.innerHTML=csUtils.truncate(e,E),s.title=e,csContactsView.bookContact(o)}),(C=csUtils.getByClassName("cloudsponge-phone-select")[0])&&csUtils.addEvent(C,"change",function(){var t=this.getAttribute("data-index"),e=this.value,o=csUtils.getByClassName("cloudsponge-contact-item").filter(function(e){if(e.getAttribute("data-index")===t)return e})[0],s=csUtils.getByClassName(o,N.PHONE_LABEL)[0];csModel.updateContactPhone(t,e),s.innerHTML=e,s.title=e,csContactsView.bookContact(o)}),(C=csUtils.getByClassName("cloudsponge-address-select")[0])&&csUtils.addEvent(C,"change",function(){var t=this.getAttribute("data-index"),e=this.value,o=csUtils.getByClassName("cloudsponge-contact-item").filter(function(e){if(e.getAttribute("data-index")===t)return e})[0],s=csUtils.getByClassName(o,N.ADDRESS_LABEL)[0];csModel.updateContactAddress(t,e),s.innerHTML=e,s.title=e,csContactsView.bookContact(o)})}),onShowContacts:function(e){csContactsView.showContacts(),csUtils.preventDefault(e)},onShowBooked:function(e){csContactsView.showBooked(),csUtils.preventDefault(e)},onContactsScroll:function(){var n=csUtils.getById(b.SEARCH_BAR),c=0;return function(){var e=n.offsetHeight;if(!i("GRANT_SCROLL")){var t=this.scrollTop,o=parseInt(n.style.top)||0,s=t-c;t<=0?o=0:t+this.clientHeight>=this.scrollHeight?o=-e:((o-=s)<-e&&(o=-e),0<o&&(o=0)),n.style.marginBottom=o+"px",n.style.top=o+"px"}c=t}},onDictClick:csUtils.delegate(function o(e){return void 0!==e.getAttribute("data-for")&&!csUtils.hasClass(e,N.DISABLED)},function T(e){var t=this.getAttribute("data-for"),o=csUtils.getById(t),s=csUtils.getById(b.CONTACTS_SCROLL),n=csUtils.getById(b.LETTER_PREVIEW);o&&(csContactsView.hideSearchBar(),n.innerHTML=t.slice(-1),csUtils.showElement(n),c("GRANT_SCROLL"),csUtils.scrollElementY(s,o.offsetTop,function(){l("GRANT_SCROLL"),setTimeout(csUtils.hideElement.bind(null,n),100)})),csUtils.preventDefault(e)}),onExportContacts:function(e){csUtils.hasClass(e.currentTarget,"disabled")||csModel.exportSelected(),csUtils.preventDefault(e)}}}(),csWidget=function(){function n(e,t){var o=document.createElement("link");return o.id=e,o.setAttribute("rel","stylesheet"),o.setAttribute("media","screen"),o.setAttribute("type","text/css"),o.href=t,o}function o(e,t){var o=csUtils.getById(e);if(o){if(o.href===t)return;o.disabled=!0,o.parentNode.removeChild(o)}if(t){var s=n(e,t);document.head.appendChild(s)}}function t(){cloudspongeUI.controller.options.skipSourceMenu||csUtils.hasClass(this,c.BACK_CLOSE)?cloudspongeUI.controller.end():csUtils.getById(c.DETAILS_TAB)?(csUtils.showElement(c.CONTACTS_TAB),csUtils.getById(c.DETAILS_TAB).remove()):csWidget.showBooksTab()}var s,c={OVERLAY:"cloudsponge-overlay",ROOT_HOLDER:"cloudsponge-root-holder",WIDGET:"cloudsponge-address-book",LOADING_OVERLAY:"cloudsponge-loading-overlay",CLOSE_BUTTON:"cloudsponge-close-button",BACK_BUTTON:"cloudsponge-back-button",DESKTOP_BACK:"cloudsponge-desktop-back-button",BACK_CLOSE:"cloudsponge-back-close",CONTACTS_TAB:"cloudsponge-contacts-tab",DETAILS_TAB:"cloudsponge-details-tab",LOADING_TAB:"cloudsponge-loading-tab",LOGIN_TAB:"cloudsponge-login-tab",IMPORT_TAB:"cloudsponge-import-tab",BOOKS_TAB:"cloudsponge-books-tab",CSS_BASE_LINK:"cloudsponge-base-css",CSS_LINK:"cloudsponge-css"},l=!1;return{initComponents:function(){var e=document.createElement("div"),t=cloudspongeUI.controller.options,o=null;csWidget.initCSS(),t.rootNodeSelector&&(o=document.querySelector(t.rootNodeSelector)),(o=o||document.body).appendChild(e),e.id=c.ROOT_HOLDER,e.innerHTML=csTemplate.parse(),!cloudspongeUI.controller.options.displayContactsColumns||-1==cloudspongeUI.controller.options.displayContactsColumns.indexOf("phone")&&-1==cloudspongeUI.controller.options.displayContactsColumns.indexOf("mailing_address")?csUtils.addClass(e,"cloudsponge-columns-2"):csUtils.addClass(e,"cloudsponge-columns-3"),csWidget.setZIndex(),csBooksView.init(t.sources),csLoginView.init(),csImportView.init(),csContactsView.init(),csWidget.initEvents(),csUtils.hideElement(c.OVERLAY),csUtils.hideElement(c.WIDGET)},removeComponents:function(){var e=csUtils.getById(c.ROOT_HOLDER);e&&e.parentNode.removeChild(e),csWidget.setActiveTab(null)},initEvents:function(){var e=csUtils.getOption("linksSelector")||csModel.OPTIONS.LINKS_SELECTOR;if(e)for(var t=document.querySelectorAll(e),o=t.length;o--;)csUtils.addEvent(t[o],"click",csWidget.onShow);var s=csUtils.getByClassName(c.CLOSE_BUTTON);for(o=s.length;o--;)csUtils.addEvent(s[o],"click",csWidget.onClose);var n=csUtils.getByClassName(c.BACK_BUTTON,c.DESKTOP_BACK);for(o=n.length;o--;)csUtils.addEvent(n[o],"click",csWidget.onBack)},initCSS:function(){var e=cloudspongeUI.controller.constants.themePaths[cloudspongeUI.controller.options.theme],t=cloudspongeUI.controller.scriptLocation.origin+(e||cloudspongeUI.controller.constants.defaultCSS);o(c.CSS_BASE_LINK,t),o(c.CSS_LINK,cloudspongeUI.controller.options.css)},initLocale:function(t){var e=null,o=cloudspongeUI.controller.constants.localePaths[cloudspongeUI.controller.options.locale];if(o?e=cloudspongeUI.controller.scriptLocation.origin+o:cloudspongeUI.controller.options.localeData&&(e=cloudspongeUI.controller.options.localeData),null!==e&&"object"==typeof e)csUtils.mixin(CS_LOCALE,e),t();else if("string"==typeof e)try{csUtils.fetchJSON(e,function(e){csUtils.mixin(CS_LOCALE,e),t()})}catch(s){cloudspongeUI.csLogger.error(s),t()}else t()},beforeLaunch:function(e){if(!l)return csUtils.triggerCallback("beforeLaunch",e)},showPopup:function(){csUtils.showElement(c.OVERLAY),csUtils.showElement(c.WIDGET),l||(l=!0,csUtils.triggerCallback("afterLaunch"))},closePopup:function(){csUtils.hideElement(c.OVERLAY),csUtils.hideElement(c.WIDGET),l=!1,csWidget.setActiveTab(null),csModel.setProvider(null)},hideTabs:function(){csUtils.hideElement(c.LOADING_TAB),csUtils.hideElement(c.CONTACTS_TAB),csUtils.hideElement(c.LOGIN_TAB),csUtils.hideElement(c.IMPORT_TAB),csUtils.hideElement(c.BOOKS_TAB)},setActiveTab:function(e,t){var o=csUtils.getById(c.ROOT_HOLDER);o&&(csUtils.removeClass(o,new RegExp(/^active-tab-\S+/)),t&&csUtils.addClass(o,"active-tab-"+t)),s=e},setSource:function(e){var t=csUtils.getById(c.WIDGET);t&&(csUtils.removeClass(t,new RegExp(/^source-\S+/)),e&&csUtils.addClass(t,"source-"+e))},showBooksTab:function(){s!==c.BOOKS_TAB&&(csWidget.hideTabs(),csWidget.setActiveTab(c.BOOKS_TAB,"books"),csUtils.showElement(c.BOOKS_TAB),csUtils.trackPage("/choose","Choose"))},showContactsTab:function(){csWidget.hideTabs(),csWidget.setActiveTab(c.CONTACTS_TAB,"contacts"),csUtils.showElement(c.CONTACTS_TAB),csContactsView.show(),csUtils.trackPage("/review/"+csModel.getProvider(),"Review")},showLoadingTab:function(e){csWidget.hideTabs(),csWidget.setActiveTab(c.LOADING_TAB,"loading"),csLoadingView.setAuthorization(),csLoadingView.loadSource(e),csUtils.showElement(c.LOADING_TAB),csUtils.trackPage("/loading/"+e,"Loading Contacts")},showLoginTab:function(){csWidget.hideTabs(),csWidget.setActiveTab(c.LOGIN_TAB,"login"),csUtils.showElement(c.LOGIN_TAB),csUtils.trackPage("/connect/"+csModel.getProvider(),"Authenticate")},showImportTab:function(){csWidget.hideTabs(),csWidget.setActiveTab(c.IMPORT_TAB,"import"),csUtils.showElement(c.IMPORT_TAB),csUtils.trackPage("/connect/"+csModel.getProvider(),"Authenticate")},setZIndex:function(){var e,t=cloudspongeUI.controller.options;"undefined"!=typeof t.zIndex?e=t.zIndex:t.floatbox&&"undefined"!=typeof t.floatbox.zIndex&&(e=t.floatbox.zIndex),void 0!==e&&(csUtils.getById(c.OVERLAY).style.zIndex=e,csUtils.getById(c.WIDGET).style.zIndex=e,csContactsView.setZIndex(e))},onShow:function(e){var t=this.getAttribute("data-cs-source")||this.getAttribute("data-cloudsponge-source");cloudspongeUI.controller.launch(t),csUtils.preventDefault(e)},onAfterClose:function(){l&&csWidget.closePopup()},onAfterClosePopup:function(){l&&t()},onClose:function(e){cloudspongeUI.controller.end(),csUtils.preventDefault(e)},onBack:function(e){t.call(this),csUtils.preventDefault(e)},afterInit:function(){csModel.initOptions(),csWidget.removeComponents(),csWidget.initLocale(function(){csWidget.initComponents(),cloudspongeUI.oauthRedirect.execute(),csUtils.triggerCallback("afterInit")})},onBeforeImport:function(e){csWidget.showLoadingTab(e),csWidget.showPopup()},onAfterImportError:function(e,t){csLoadingView.failSource(e,t),csWidget.setActiveTab(c.LOADING_TAB,"error"),csUtils.showElement(c.LOADING_TAB),csUtils.triggerCallback("onImportError"),csUtils.trackEvent("onImportError"),csUtils.trackPage("/error/"+e.toLowerCase()+"/"+t,"Error")},onBeforeDisplayContacts:function(e,t,o,s,n){csModel.setProvider(t),csModel.setOwner(o),csModel.setContacts(e),csModel.setImportId(n),csStorage.addSource(t,o,e,n),s||csWidget.onSkipContactsDisplay(e)},onSkipContactsDisplay:function(e){cloudspongeUI.controller.options.skipContactsDisplay?(csModel.appendToTextArea(e),csWidget.closePopup()):csWidget.showContactsTab()},onMoveFocus:function(e){var t=cloudspongeUI.controller.options&&("undefined"==typeof cloudspongeUI.controller.options.modalDialog||cloudspongeUI.controller.options.modalDialog);if(l&&t){for(var o=e.target,s=csUtils.getById(c.ROOT_HOLDER);o;){if(o===s)return void e.stopPropagation();o=o.parentNode}csUtils.preventDefault(e)}}}}();cloudspongeUI.csWidget=csWidget,cloudsponge.launch=cloudspongeUI.controller.launch,cloudsponge.end=cloudspongeUI.controller.end,cloudsponge.options=cloudspongeUI.controller.options,cloudsponge.showContacts=cloudspongeUI.controller.showContacts,cloudsponge.showProgress=cloudspongeUI.controller.showProgress,cloudsponge.init=cloudspongeUI.controller.init,window.csLaunch=cloudsponge.launch,window.csInit=cloudspongeUI.controller.init,function(e){document.body&&("complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll)?e():document.addEventListener("DOMContentLoaded",e)}(function(){var e=cloudsponge.require("v16/authToken"),t=function(){cloudsponge.init()};csUtils.triggerCallback("afterLoad"),e({callback:t,onerror:t})}),function(){}.call(this);
//# sourceMappingURL=/assets/maps/address_books/address_books16-c88d26e60aec9508722b754e39c5707cc7a8e35575c6c291970c74830759f077.js.map
